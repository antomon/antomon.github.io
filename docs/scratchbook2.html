<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>scratchbook2 – Bits of Knowledge</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0626ff4d7a71b55c8707dcae1d04a9b6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-13484e71349f5563e74c1d2bdd5b186c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=663ff7b280d7c0001914e592&amp;product=sticky-share-buttons" async="async"></script>
<script src="https://cdn.jsdelivr.net/npm/typewriter-effect@latest/dist/core.js"></script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Bits of Knowledge">
<meta property="og:description" content="Antonio Montano’s Personal Website">
<meta property="og:site_name" content="Bits of Knowledge">
<meta name="twitter:title" content="Bits of Knowledge">
<meta name="twitter:description" content="Antonio Montano’s Personal Website">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./favicon.png" alt="AM logo" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Bits of Knowledge</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./contents/services.html"> 
<span class="menu-text">Services</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://4m4.it/corso-python/"> 
<span class="menu-text">Corso Python</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/montano/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/antomon"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/antomon"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="./index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title"></h1>
        </a>     
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Legacy encryption systems rely heavily on the concept of key sharing to secure communications. In these systems, the key—whether public or private—must be distributed among all parties involved in exchanging an encrypted message. This traditional approach presents notable privacy and security challenges, particularly because it requires trust in whoever holds the key. Whoever possesses the key has full control over the encrypted data, meaning that service providers or intermediaries can, in principle, access, manage, and exploit the sensitive information, depending on their level of access. This setup becomes especially worrisome when we consider the growing reliance on popular cloud services to store and process personal or proprietary data.</p>
<p>When users or businesses upload their encrypted data to the cloud, they relinquish some control over their privacy, even if they do not directly share their encryption keys. For example, consider a healthcare provider that needs to store patient medical records in the cloud to enable research and improve patient outcomes. Even if the data is encrypted, the cloud provider still has the ability to access metadata, such as timestamps, file sizes, and usage patterns. This metadata could potentially be used to infer sensitive information, like the frequency of record access or correlations between patients and certain conditions, without actually decrypting the data. Furthermore, the cloud provider may retain this metadata or identifying elements long after the healthcare provider ends its relationship with them, which creates persistent privacy risks. This makes data vulnerable to breaches or misuse, especially in cases where cloud operators, servers, or service providers are untrusted.</p>
<p>Homomorphic Encryption (HE) emerges as a promising solution to address these concerns. HE is a type of encryption that allows computations to be performed directly on encrypted data without requiring prior decryption. In other words, third parties can perform operations—such as statistical analysis or machine learning processes—on encrypted datasets without ever seeing the raw, sensitive information. This unique feature of HE dramatically reduces privacy concerns, since the data remains secure and unreadable at all times during the computation process. This is a major advantage over traditional encryption schemes, where data must typically be decrypted before operations can be performed, thus exposing it to potential vulnerabilities.</p>
<p>Encryption methods like RSA, AES, and DES are not homomorphic, meaning that they require the data to be decrypted before any computation can be performed. This makes it challenging to use these encryption methods in situations where data privacy is a critical concern, such as cloud computing and data analytics.</p>
<section id="real-world-example-medical-research" class="level3">
<h3 class="anchored" data-anchor-id="real-world-example-medical-research">Real-world example: medical research</h3>
<p>Consider a medical research company working with sensitive patient data to develop new treatments. The company needs to analyze large datasets containing personal health information across multiple hospital networks but wants to maintain patient privacy and comply with healthcare regulations. Using traditional encryption methods, they might encrypt the data before uploading it to a cloud service provider for processing. However, to perform any meaningful analysis—such as identifying patterns in treatment outcomes or running statistical models—the data must first be decrypted. This creates a critical vulnerability: the cloud service provider must have access to the decryption keys to process the information.</p>
<p>Even if the cloud provider is contractually bound to protect the data, several risks emerge. First, any employee with sufficient access privileges could potentially view sensitive patient information. Second, if the provider’s systems are compromised, attackers could gain access to both the encrypted data and the means to decrypt it. Third, the medical company loses direct control over how their data is handled once it’s decrypted for processing. The provider could, intentionally or unintentionally, create unauthorized copies, fail to properly delete sensitive information, or expose the data through misconfigured security settings. This scenario illustrates how traditional encryption becomes a potential liability when data needs to be both stored and processed by third parties—a common requirement in today’s interconnected digital landscape.</p>
</section>
<section id="the-problem-with-metadata" class="level3">
<h3 class="anchored" data-anchor-id="the-problem-with-metadata">The problem with metadata</h3>
<p>More troubling still, even without decrypting the data itself, service providers can often infer sensitive information merely by analyzing patterns and metadata. Consider a cloud-based email service that stores encrypted messages. While the provider cannot read the actual content of the emails, they can observe message frequencies, sizes, timestamps, and communication patterns. For instance, if a user suddenly starts exchanging frequent messages with email addresses belonging to oncology clinics, followed by regular correspondence with insurance companies and pharmaceutical suppliers, the provider could infer that the user likely has a cancer diagnosis—all without ever decrypting a single message. Similarly, in financial services, encrypted transaction data can reveal spending patterns, income levels, and lifestyle changes through metadata alone. A sudden increase in encrypted transactions with medical facilities, followed by regular payments to a specific pharmacy, could indicate the development of a chronic condition, even though the transaction details remain encrypted.</p>
<p>The metadata vulnerability extends far beyond medical privacy. Consider these real-world scenarios:</p>
<ol type="1">
<li><p><strong>Corporate mergers and acquisitions</strong>: When a company is preparing for a merger, their encrypted network traffic patterns can reveal the negotiations even if the content remains secret. Sudden increases in encrypted communications between two companies’ legal departments, followed by regular virtual meetings between executive teams, can signal impending corporate deals. Competitors monitoring these patterns could gain unfair market advantages or manipulate stock prices, despite never accessing the encrypted contents.</p></li>
<li><p><strong>Military operations</strong>: Even with encrypted communications, the volume and timing of military messages can telegraph impending operations. A sudden spike in encrypted traffic between command centers and specific field units, combined with changes in satellite image requests for particular regions, could reveal planned operations to adversaries monitoring these patterns.</p></li>
<li><p><strong>Political campaigns</strong>: Campaign strategies can be exposed through metadata analysis of encrypted communications. The pattern of messages between campaign headquarters and local offices, combined with the timing and location of ad purchases and voter database queries, can reveal targeting strategies and key battleground areas—all while the actual message content remains encrypted.</p></li>
<li><p><strong>Personal relationships</strong>: Social mapping through encrypted messaging patterns can reveal sensitive personal information. The frequency, timing, and duration of encrypted video calls, combined with location data and message sizes, can expose romantic relationships, family dynamics, or personal crises, even when the communication content is completely secured.</p></li>
<li><p><strong>Research and development</strong>: Companies developing new products leave metadata footprints despite using encryption. Patterns in encrypted traffic between research facilities, patent offices, and manufacturing partners can reveal product development timelines and strategic initiatives to competitors, even without access to the actual encrypted data.</p></li>
</ol>
<p>These examples demonstrate how traditional encryption, while securing individual data points, fails to protect against sophisticated pattern analysis that can reveal highly sensitive information through metadata alone. The ability to derive meaningful intelligence from encrypted data patterns undermines the fundamental promise of privacy that encryption is meant to provide. This “side-channel” vulnerability highlights why modern privacy solutions must address not only the security of the data itself but also the patterns of its usage and transmission.</p>
</section>
<section id="the-journey-of-fully-homomorphic-encryption" class="level3">
<h3 class="anchored" data-anchor-id="the-journey-of-fully-homomorphic-encryption">The journey of fully Homomorphic Encryption</h3>
<p>Despite its immense potential, the practical application of Fully Homomorphic Encryption (FHE) has faced significant challenges. The idea behind HE has been around for over three decades, but it wasn’t until 2009 that Craig Gentry introduced the first plausible and functional FHE scheme. Gentry’s scheme was a major breakthrough, as it demonstrated that it was theoretically possible to allow any arbitrary computation to be performed on encrypted data—effectively enabling encrypted data to be processed in the same way as unencrypted data. This marked a new era for secure data processing, promising an unprecedented level of privacy.</p>
<p>However, the journey towards making FHE practical for widespread use has proven to be difficult. Early implementations of Gentry’s scheme, while groundbreaking, were computationally expensive and impractical for real-world applications due to their immense computational overhead and resource requirements. As a result, while the concept of FHE is extraordinarily appealing, current implementations are often slow and require significant computational power, which limits their usability in consumer applications and even in some enterprise-level environments. Researchers continue to work on improving these encryption schemes, making them more efficient and scalable, but the progress towards making FHE truly practical on all platforms remains an ongoing challenge.</p>
</section>
</section>
<section id="mathematical-background" class="level2">
<h2 class="anchored" data-anchor-id="mathematical-background">Mathematical background</h2>
<p>Homomorphic Encryption relies on fundamental concepts in algebra and number theory to enable secure computation on encrypted data without needing decryption. One of the key mathematical principles underlying Homomorphic Encryption is the notion of <strong>homomorphisms</strong>, which are structure-preserving maps between algebraic systems such as groups, rings, or fields. In the context of encryption, this means that certain operations on the ciphertext correspond directly to operations on the plaintext, preserving the underlying structure of the data.</p>
<p>To better understand this, let us consider two plaintext messages, <span class="math inline">m_1</span> and <span class="math inline">m_2</span>, and their corresponding encrypted ciphertexts, <span class="math inline">c_1 = E(m_1)</span> and <span class="math inline">c_2 = E(m_2)</span>, where <span class="math inline">E</span> represents the encryption function. If the encryption scheme is homomorphic, it should allow computations on <span class="math inline">c_1</span> and <span class="math inline">c_2</span> to yield an encrypted result that matches the operation applied to the plaintexts. For example, if we add <span class="math inline">m_1</span> and <span class="math inline">m_2</span>, then the encrypted sum can be obtained directly by operating on <span class="math inline">c_1</span> and <span class="math inline">c_2</span> without needing to decrypt them first:</p>
<p><span class="math display">
E(m_1 + m_2) = c_1 + c_2 = E(m_1) + E(m_2)
</span></p>
<p>This property allows computations to be performed on encrypted data without decrypting it, thus preserving privacy and security. The same concept can be applied to other operations, such as multiplication. If the encryption scheme supports an operation like addition or multiplication directly in the encrypted space, it is said to be homomorphic for that operation.</p>
<section id="defining-homomorphic-encryption-mathematically" class="level3">
<h3 class="anchored" data-anchor-id="defining-homomorphic-encryption-mathematically">Defining Homomorphic Encryption mathematically</h3>
<p>Imagine a scenario where the operation is represented by <span class="math inline">+</span> in the plaintext space, and let <span class="math inline">E</span> be an encryption scheme. <span class="math inline">E</span> is said to be homomorphic if it satisfies the following equation for all possible plaintexts <span class="math inline">m_1, m_2</span>:</p>
<p><span class="math display">
E(m_1 + m_2) = E(m_1) + E(m_2)
</span></p>
<p>where <span class="math inline">M</span> is the set of all possible messages. In abstract algebra, a structure-preserving map between two algebraic structures or groups is called a homomorphism. For instance, if we consider a set <span class="math inline">S</span> and an operation <span class="math inline">+</span>, which combines any two elements <span class="math inline">a</span> and <span class="math inline">b</span> to form another element <span class="math inline">a + b</span>, the set <span class="math inline">(S, +)</span> must satisfy the following properties to be a group:</p>
<ol type="1">
<li><p><strong>Closure property</strong>: For all <span class="math inline">a, b \in S</span>, the result of <span class="math inline">a + b</span> must also belong to <span class="math inline">S</span>.</p></li>
<li><p><strong>Associativity property</strong>: For all <span class="math inline">a, b, c \in S</span>, <span class="math inline">(a + b) + c = a + (b + c)</span>.</p></li>
<li><p><strong>Identity element</strong>: There exists an element <span class="math inline">e \in S</span> such that <span class="math inline">e + a = a</span> for all <span class="math inline">a \in S</span>. This element <span class="math inline">e</span> is known as the identity element.</p></li>
<li><p><strong>Inverse element</strong>: For every element <span class="math inline">a \in S</span>, there exists an element <span class="math inline">b \in S</span> such that <span class="math inline">a + b = b + a = e</span>, where <span class="math inline">e</span> is the identity element.</p></li>
</ol>
<p>These properties are fundamental in defining group structures that are used in Homomorphic Encryption.</p>
</section>
<section id="group-homomorphism" class="level3">
<h3 class="anchored" data-anchor-id="group-homomorphism">Group homomorphism</h3>
<p>Group homomorphisms come into play when testing whether an encryption scheme is homomorphic or not. Consider a group homomorphism <span class="math inline">f: G
ightarrow H</span>, where <span class="math inline">G</span> and <span class="math inline">H</span> are groups, and the function <span class="math inline">f</span> holds the property:</p>
<p><span class="math display">
f(g_1 \ast g_2) = f(g_1) \circ f(g_2), \quad orall g_1, g_2 \in G
</span></p>
<p>where <span class="math inline">\ast</span> and <span class="math inline">\circ</span> are the group operations in <span class="math inline">G</span> and <span class="math inline">H</span>, respectively. Similarly, in an encryption scheme, if we denote the plaintext group by <span class="math inline">P</span> and the ciphertext group by <span class="math inline">C</span>, and if using a specific key <span class="math inline">k</span>, the encryption scheme <span class="math inline">E</span> maps elements of <span class="math inline">P</span> to elements of <span class="math inline">C</span>, then for an operation <span class="math inline">\star</span>, the homomorphic property can be expressed as:</p>
<p><span class="math display">
E_{k}(a) \star E_{k}(b) = E_{k}(a \star b), \quad orall a, b \in P, k \in K
</span></p>
<p>Here, <span class="math inline">k</span> can be a symmetric key or a public key, depending on the encryption algorithm used.</p>
</section>
<section id="example-rsa" class="level3">
<h3 class="anchored" data-anchor-id="example-rsa">Example: RSA</h3>
<p>A concrete example of Homomorphic Encryption is the RSA algorithm, which is partially homomorphic for multiplication. In RSA, plaintext <span class="math inline">p</span> is encrypted to produce ciphertext <span class="math inline">c</span> using a public key <span class="math inline">(e, n)</span> where <span class="math inline">n</span> is the product of two large primes and <span class="math inline">e</span> is the encryption exponent. For two plaintexts <span class="math inline">p_1, p_2 \in P</span>, the encrypted values are given by:</p>
<p><span class="math display">
E(p_1) = p_1^e \mod n \quad     ext{and} \quad E(p_2) = p_2^e \mod n
</span></p>
<p>Using these encrypted values, we can compute:</p>
<p><span class="math display">
E(p_1) \cdot E(p_2) = (p_1^e \mod n) \cdot (p_2^e \mod n) = (p_1 \cdot p_2)^e \mod n = E(p_1 \cdot p_2)
</span></p>
<p>Thus, RSA is homomorphic for modular multiplication, meaning that multiplying two ciphertexts yields a ciphertext that, when decrypted, is equivalent to the product of the original plaintexts. However, RSA is not homomorphic for addition, which limits its usefulness as a fully Homomorphic Encryption scheme.</p>
</section>
</section>
<section id="classification-of-algorithms" class="level2">
<h2 class="anchored" data-anchor-id="classification-of-algorithms">Classification of algorithms</h2>
<p>Homomorphic Encryption algorithms are classified based on the types of operations they support and the extent to which they allow computations on encrypted data. The existing encryption schemes have inherent limitations and may not all satisfy homomorphism for every kind of operation or support an unlimited number of operations. Some encryption algorithms are homomorphic for addition or multiplication operations only, while others may support an infinite number of subsequent additions but only a limited number of multiplications. As a result, Homomorphic Encryption algorithms are categorized into three primary types: Partially Homomorphic Encryption (PHE), Somewhat Homomorphic Encryption (SWHE), and Fully Homomorphic Encryption (FHE).</p>
<section id="partially-homomorphic-encryption" class="level3">
<h3 class="anchored" data-anchor-id="partially-homomorphic-encryption">Partially Homomorphic Encryption</h3>
<p>Partially Homomorphic Encryption (PHE) schemes are encryption methods that allow computations on encrypted data, but only for a limited number of operations. Typically, PHE supports either addition or multiplication, but not both. This limited operation support makes PHE less computationally costly compared to other types of Homomorphic Encryption, which is beneficial for applications where only basic operations are needed. However, the limited utility of PHE also restricts its use in more complex data processing scenarios.</p>
<p>For instance, RSA is a well-known PHE scheme that supports homomorphic multiplication. This means that given two encrypted values, the product of these values can be calculated without decryption. Goldwasser-Micali is another example of a PHE scheme that supports homomorphic addition. While these schemes are useful in situations where specific operations are required, they cannot handle arbitrary computations.</p>
<p>Other examples of PHE schemes include:</p>
<ul>
<li><p><strong>El-Gamal</strong>: Supports multiplication operations on encrypted data.</p></li>
<li><p><strong>Benaloh</strong>: Extends Goldwasser-Micali to support larger message spaces while maintaining additive homomorphism.</p></li>
<li><p><strong>Paillier</strong>: A widely used PHE scheme that supports additive operations.</p></li>
<li><p><strong>Okamoto-Uchiyama</strong>: Supports additive homomorphism, similar to the Paillier scheme.</p></li>
</ul>
<p>These PHE schemes are generally more efficient in terms of computational resources, making them suitable for specific use cases such as secure voting, basic privacy-preserving data aggregation, and simple cryptographic protocols where only one type of operation is required.</p>
</section>
<section id="somewhat-homomorphic-encryption" class="level3">
<h3 class="anchored" data-anchor-id="somewhat-homomorphic-encryption">Somewhat Homomorphic Encryption</h3>
<p>Somewhat Homomorphic Encryption (SWHE) enables more complex operations on encrypted data compared to PHE. SWHE schemes can support both addition and multiplication, but only up to a certain depth or a limited number of times. This means that SWHE can handle more complicated functions, such as polynomial evaluations or basic exponentiation, but it is still constrained by the level of complexity and the number of operations it can perform before decryption becomes necessary.</p>
<p>SWHE is more computationally demanding than PHE due to the increased complexity of the operations it supports. However, it offers more capabilities, making it suitable for applications that require a moderate level of data processing without compromising security. For instance, SWHE can be used in machine learning models for simple training tasks where data privacy must be preserved, but the complexity of the operations is not too high.</p>
<p>Examples of SWHE schemes include:</p>
<ul>
<li><p><strong>BGN (Boneh-Goh-Nissim)</strong>: Supports both addition and a limited number of multiplications, making it a versatile SWHE scheme.</p></li>
<li><p><strong>Polly Cracker scheme</strong>: Allows for the evaluation of polynomials on encrypted data, providing more flexibility compared to PHE.</p></li>
</ul>
<p>The utility of SWHE lies in its ability to perform a combination of operations on encrypted data while maintaining data privacy. However, the noise introduced during each operation accumulates, which limits the depth of computations that can be performed. Techniques such as noise management and re-encryption are often employed to mitigate this issue, although these techniques also add to the computational overhead.</p>
</section>
<section id="fully-homomorphic-encryption" class="level3">
<h3 class="anchored" data-anchor-id="fully-homomorphic-encryption">Fully Homomorphic Encryption</h3>
<p>Fully Homomorphic Encryption (FHE) is the most advanced form of Homomorphic Encryption, supporting arbitrary computations on encrypted data, including complex operations like conditional statements, branching, and looping. Unlike PHE and SWHE, FHE allows for an unlimited number of additions and multiplications, making it suitable for virtually any type of computation on encrypted data. This flexibility makes FHE the most powerful but also the most computationally expensive type of Homomorphic Encryption.</p>
<p>FHE schemes typically rely on techniques like <strong>bootstrapping</strong> to maintain homomorphism over an extended series of computations. Bootstrapping is a process used to reduce the noise that accumulates during homomorphic operations, effectively refreshing the ciphertext so that further computations can be performed without losing accuracy. However, bootstrapping is computationally intensive, and optimizing it remains an active area of research in cryptography.</p>
<p>Examples of FHE schemes include:</p>
<ul>
<li><p><strong>Ideal Lattice-Based FHE</strong>: Utilizes lattice-based cryptography to provide security against quantum attacks and support homomorphic operations. Lattice structures make it possible to perform a wide range of operations, but managing the noise remains a significant challenge.</p></li>
<li><p><strong>FHE schemes over integers</strong>: These schemes use arithmetic over large integers to achieve homomorphism. They are conceptually simpler than lattice-based schemes but may require larger ciphertext sizes for the same level of security.</p></li>
<li><p><strong>LWE-based (Learning With Errors)</strong>: These schemes are based on the Learning With Errors problem, which provides strong security guarantees. LWE-based schemes are known for their resistance to quantum attacks, making them a promising candidate for post-quantum cryptography.</p></li>
<li><p><strong>NTRU-like schemes</strong>: Derived from the NTRU encryption algorithm, these schemes use polynomial rings to achieve homomorphic properties. They are efficient compared to other FHE schemes but still face challenges related to noise management and ciphertext size.</p></li>
</ul>
<p>FHE has numerous applications, particularly in areas that require secure, privacy-preserving computations. For example, in healthcare, FHE can be used to analyze encrypted patient data without compromising patient privacy. In finance, FHE enables secure computations on encrypted financial records, allowing institutions to perform risk assessments and fraud detection while maintaining data confidentiality. FHE also holds promise in cloud computing, where sensitive data can be processed by cloud servers without revealing the underlying information.</p>
</section>
<section id="applications" class="level3">
<h3 class="anchored" data-anchor-id="applications">Applications</h3>
<p>All three schemes of Homomorphic Encryption—PHE, SWHE, and FHE—are useful in any field that deals with data processing. They can be utilized in outsourcing storage and computation sectors where customers can share data with an outsourcing corporation without disclosing sensitive information, while allowing the companies to perform operations on the data.</p>
<p>One such example is a system architecture capable of performing biometric identification in the encrypted domain, as discussed in [1]. This system allows the implementation of Homomorphic Encryption techniques to maintain privacy while analyzing biometric data, overcoming technological challenges in secure processing environments.</p>
<p>Let’s consider a sample client-server interaction scenario where the client needs to send sensitive data to the server, and the server returns the data after performing certain operations. This scenario can be achieved with or without using Homomorphic Encryption (HE). Both methods are illustrated below:</p>
<section id="without-homomorphic-encryption" class="level4">
<h4 class="anchored" data-anchor-id="without-homomorphic-encryption">Without Homomorphic Encryption</h4>
<p>Client (C) has an asymmetric key pair <span class="math inline">(    ext{pu}_C,  ext{pr}_C)</span> and a message <span class="math inline">M</span> that must be sent to the server. Similarly, server (S) has its asymmetric key pair <span class="math inline">( ext{pu}_S,  ext{pr}_S)</span> and a function <span class="math inline">f</span> which will be applied to the client’s message. To maintain confidentiality, the client encrypts <span class="math inline">M</span> using the server’s public key to form <span class="math inline">E(M,  ext{pu}_S)</span>, which is then sent to the server. The server decrypts <span class="math inline">E(M,    ext{pu}_S)</span> using its private key $ ext{pr}_S$ to get <span class="math inline">M</span>, performs the function <span class="math inline">f</span> on <span class="math inline">M</span> to get <span class="math inline">f(M)</span>, and then encrypts <span class="math inline">f(M)</span> using the client’s public key $ ext{pu}_C$ before sending it back to the client. The client receives <span class="math inline">E(f(M),   ext{pu}_C)</span> and decrypts it using its private key to get <span class="math inline">f(M)</span>.</p>
<p>In this scenario, the server has full visibility of the message, which poses a significant security risk for the client. When dealing with sensitive data, there must be a way to prevent the server from viewing the raw data.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<svg width="672" height="480" viewbox="0.00 0.00 618.39 130.78" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 126.78)">
<title>ClientServerWithoutHE</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-126.78 614.39,-126.78 614.39,4 -4,4"></polygon>
<!-- Client -->
<g id="node1" class="node">
<title>Client</title>
<polygon fill="none" stroke="black" points="165.67,-54.78 92.9,-54.78 92.9,-18.78 165.67,-18.78 165.67,-54.78"></polygon>
<text text-anchor="middle" x="129.29" y="-32.58" font-family="Times,serif" font-size="14.00">Client (C)</text>
</g>
<!-- Client&#45;&gt;Client -->
<g id="edge5" class="edge">
<title>Client-&gt;Client</title>
<path fill="none" stroke="black" d="M96.36,-54.93C91.3,-64.32 102.27,-72.78 129.29,-72.78 145.75,-72.78 156.26,-69.64 160.81,-65.06"></path>
<polygon fill="black" stroke="black" points="164.3,-65.32 162.21,-54.93 157.37,-64.35 164.3,-65.32"></polygon>
<text text-anchor="middle" x="129.29" y="-76.98" font-family="Times,serif" font-size="14.00">5. C decrypts E(f(M), pu_C) using pr_C: f(M)</text>
</g>
<!-- Server -->
<g id="node2" class="node">
<title>Server</title>
<polygon fill="none" stroke="black" points="534.06,-54.78 460.77,-54.78 460.77,-18.78 534.06,-18.78 534.06,-54.78"></polygon>
<text text-anchor="middle" x="497.42" y="-32.58" font-family="Times,serif" font-size="14.00">Server (S)</text>
</g>
<!-- Client&#45;&gt;Server -->
<g id="edge1" class="edge">
<title>Client-&gt;Server</title>
<path fill="none" stroke="black" d="M165.73,-36.78C232.35,-36.78 376.22,-36.78 450.28,-36.78"></path>
<polygon fill="black" stroke="black" points="450.69,-40.28 460.69,-36.78 450.69,-33.28 450.69,-40.28"></polygon>
<text text-anchor="middle" x="313.16" y="-40.98" font-family="Times,serif" font-size="14.00">1. C encrypts M using pu_S: E(M, pu_S)</text>
</g>
<!-- Server&#45;&gt;Client -->
<g id="edge4" class="edge">
<title>Server-&gt;Client</title>
<path fill="none" stroke="black" d="M460.64,-20.81C454.79,-18.81 448.73,-17.08 442.84,-15.98 329.54,5.25 296.76,5.38 183.48,-15.98 180.79,-16.49 178.05,-17.13 175.32,-17.86"></path>
<polygon fill="black" stroke="black" points="174.03,-14.6 165.51,-20.91 176.1,-21.29 174.03,-14.6"></polygon>
<text text-anchor="middle" x="313.16" y="-19.98" font-family="Times,serif" font-size="14.00">4. S encrypts f(M) using pu_C: E(f(M), pu_C)</text>
</g>
<!-- Server&#45;&gt;Server -->
<g id="edge2" class="edge">
<title>Server-&gt;Server</title>
<path fill="none" stroke="black" d="M480.77,-54.93C478.21,-64.32 483.76,-72.78 497.42,-72.78 505.74,-72.78 511.05,-69.64 513.35,-65.06"></path>
<polygon fill="black" stroke="black" points="516.85,-65.15 514.06,-54.93 509.87,-64.66 516.85,-65.15"></polygon>
<text text-anchor="middle" x="497.42" y="-76.98" font-family="Times,serif" font-size="14.00">2. S decrypts E(M, pu_S) using pr_S: M</text>
</g>
<!-- Server&#45;&gt;Server -->
<g id="edge3" class="edge">
<title>Server-&gt;Server</title>
<path fill="none" stroke="black" d="M469.52,-55.03C455.05,-72.18 464.35,-90.78 497.42,-90.78 524.8,-90.78 535.88,-78.02 530.66,-63.9"></path>
<polygon fill="black" stroke="black" points="533.48,-61.79 525.31,-55.03 527.48,-65.4 533.48,-61.79"></polygon>
<text text-anchor="middle" x="497.42" y="-94.98" font-family="Times,serif" font-size="14.00">3. S performs f on M: f(M)</text>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="with-homomorphic-encryption" class="level4">
<h4 class="anchored" data-anchor-id="with-homomorphic-encryption">With Homomorphic Encryption</h4>
<p>Client (C) has a Homomorphic Encryption function <span class="math inline">He</span>, its corresponding decryption function <span class="math inline">Hd</span>, and a message <span class="math inline">M</span> that must be processed by the server. The server (S) has a function <span class="math inline">f</span> that needs to be applied to the client’s data. The client encrypts the message <span class="math inline">M</span> using Homomorphic Encryption to obtain <span class="math inline">He(M)</span> and sends it to the server for computation. The server performs the operation <span class="math inline">f</span> homomorphically to get <span class="math inline">He(f(M))</span> and sends it back to the client. The client then decrypts the data using <span class="math inline">Hd(He(f(M)))</span> to get <span class="math inline">f(M)</span>.</p>
<p>Unlike the previous scenario, here the server performs its operations without being able to see the original message. The confidentiality of the client’s data is preserved, both from the public and from the server itself.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<svg width="672" height="480" viewbox="0.00 0.00 516.47 93.27" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 89.27)">
<title>ClientServerWithHE</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-89.27 512.47,-89.27 512.47,4 -4,4"></polygon>
<!-- Client -->
<g id="node1" class="node">
<title>Client</title>
<polygon fill="none" stroke="black" points="145.44,-50.47 72.68,-50.47 72.68,-14.47 145.44,-14.47 145.44,-50.47"></polygon>
<text text-anchor="middle" x="109.06" y="-28.27" font-family="Times,serif" font-size="14.00">Client (C)</text>
</g>
<!-- Client&#45;&gt;Client -->
<g id="edge4" class="edge">
<title>Client-&gt;Client</title>
<path fill="none" stroke="black" d="M82.29,-50.62C78.17,-60 87.09,-68.47 109.06,-68.47 122.45,-68.47 130.99,-65.32 134.69,-60.74"></path>
<polygon fill="black" stroke="black" points="138.19,-60.95 135.83,-50.62 131.23,-60.16 138.19,-60.95"></polygon>
<text text-anchor="middle" x="109.06" y="-72.67" font-family="Times,serif" font-size="14.00">4. C decrypts He(f(M)) using Hd: f(M)</text>
</g>
<!-- Server -->
<g id="node2" class="node">
<title>Server</title>
<polygon fill="none" stroke="black" points="443.84,-50.47 370.54,-50.47 370.54,-14.47 443.84,-14.47 443.84,-50.47"></polygon>
<text text-anchor="middle" x="407.19" y="-28.27" font-family="Times,serif" font-size="14.00">Server (S)</text>
</g>
<!-- Client&#45;&gt;Server -->
<g id="edge1" class="edge">
<title>Client-&gt;Server</title>
<path fill="none" stroke="black" d="M145.49,-32.47C199.07,-32.47 300.76,-32.47 360.06,-32.47"></path>
<polygon fill="black" stroke="black" points="360.26,-35.97 370.26,-32.47 360.26,-28.97 360.26,-35.97"></polygon>
<text text-anchor="middle" x="257.93" y="-36.67" font-family="Times,serif" font-size="14.00">1. C encrypts M using He: He(M)</text>
</g>
<!-- Server&#45;&gt;Client -->
<g id="edge3" class="edge">
<title>Server-&gt;Client</title>
<path fill="none" stroke="black" d="M370.41,-16.5C364.57,-14.5 358.5,-12.77 352.61,-11.67 269.89,3.83 245.96,3.93 163.25,-11.67 160.56,-12.17 157.83,-12.81 155.1,-13.55"></path>
<polygon fill="black" stroke="black" points="153.8,-10.29 145.28,-16.6 155.87,-16.98 153.8,-10.29"></polygon>
<text text-anchor="middle" x="257.93" y="-15.67" font-family="Times,serif" font-size="14.00">3. S sends He(f(M)) to C</text>
</g>
<!-- Server&#45;&gt;Server -->
<g id="edge2" class="edge">
<title>Server-&gt;Server</title>
<path fill="none" stroke="black" d="M380.41,-50.62C376.29,-60 385.22,-68.47 407.19,-68.47 420.58,-68.47 429.12,-65.32 432.82,-60.74"></path>
<polygon fill="black" stroke="black" points="436.32,-60.95 433.96,-50.62 429.36,-60.16 436.32,-60.95"></polygon>
<text text-anchor="middle" x="407.19" y="-72.67" font-family="Times,serif" font-size="14.00">2. S performs f on He(M): He(f(M))</text>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="code" class="level2">
<h2 class="anchored" data-anchor-id="code">Code</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> random</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">from</span> typing <span class="im">import</span> Tuple <span class="co">#1</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">def</span> generate_keys() <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>, <span class="bu">int</span>]: <span class="co">#2</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>    p <span class="op">=</span> <span class="dv">17</span>  <span class="co">#3</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>    q <span class="op">=</span> <span class="dv">23</span>  <span class="co">#4</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>    n <span class="op">=</span> p <span class="op">*</span> q</span>
<span id="cb1-9"><a href="#cb1-9"></a>    <span class="cf">return</span> n, p, q</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="kw">def</span> encrypt(plaintext: <span class="bu">int</span>, public_key: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>: <span class="co">#5</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>    noise <span class="op">=</span> random.randint(<span class="dv">1</span>, <span class="dv">5</span>)  <span class="co">#6</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>    <span class="cf">return</span> plaintext <span class="op">+</span> noise <span class="op">*</span> public_key</span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="kw">def</span> decrypt(ciphertext: <span class="bu">int</span>, p: <span class="bu">int</span>, q: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>: <span class="co">#7</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>    n <span class="op">=</span> p <span class="op">*</span> q</span>
<span id="cb1-17"><a href="#cb1-17"></a>    <span class="cf">return</span> ciphertext <span class="op">%</span> n</span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="kw">def</span> homomorphic_add(c1: <span class="bu">int</span>, c2: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>: <span class="co">#8</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>    <span class="cf">return</span> c1 <span class="op">+</span> c2</span>
<span id="cb1-21"><a href="#cb1-21"></a></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="kw">def</span> homomorphic_multiply(c1: <span class="bu">int</span>, c2: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>: <span class="co">#9</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>    <span class="cf">return</span> c1 <span class="op">*</span> c2</span>
<span id="cb1-24"><a href="#cb1-24"></a></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="kw">def</span> demonstrate_simple_fhe(): <span class="co">#10</span></span>
<span id="cb1-26"><a href="#cb1-26"></a>    <span class="bu">print</span>(<span class="st">"=== Simple Educational FHE Demo ==="</span>)</span>
<span id="cb1-27"><a href="#cb1-27"></a>    </span>
<span id="cb1-28"><a href="#cb1-28"></a>    public_key, p, q <span class="op">=</span> generate_keys()</span>
<span id="cb1-29"><a href="#cb1-29"></a>    <span class="bu">print</span>(<span class="ss">f"Keys - Public: </span><span class="sc">{</span>public_key<span class="sc">}</span><span class="ss">, Private: (p=</span><span class="sc">{</span>p<span class="sc">}</span><span class="ss">, q=</span><span class="sc">{</span>q<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb1-30"><a href="#cb1-30"></a>    </span>
<span id="cb1-31"><a href="#cb1-31"></a>    m1, m2 <span class="op">=</span> <span class="dv">3</span>, <span class="dv">4</span> <span class="co">#11</span></span>
<span id="cb1-32"><a href="#cb1-32"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Original messages: m1=</span><span class="sc">{</span>m1<span class="sc">}</span><span class="ss">, m2=</span><span class="sc">{</span>m2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-33"><a href="#cb1-33"></a>    </span>
<span id="cb1-34"><a href="#cb1-34"></a>    c1 <span class="op">=</span> encrypt(m1, public_key) <span class="co">#12</span></span>
<span id="cb1-35"><a href="#cb1-35"></a>    c2 <span class="op">=</span> encrypt(m2, public_key)</span>
<span id="cb1-36"><a href="#cb1-36"></a>    <span class="bu">print</span>(<span class="ss">f"Encrypted messages: c1=</span><span class="sc">{</span>c1<span class="sc">}</span><span class="ss">, c2=</span><span class="sc">{</span>c2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-37"><a href="#cb1-37"></a>    </span>
<span id="cb1-38"><a href="#cb1-38"></a>    c_add <span class="op">=</span> homomorphic_add(c1, c2) <span class="co">#13</span></span>
<span id="cb1-39"><a href="#cb1-39"></a>    c_mult <span class="op">=</span> homomorphic_multiply(c1, c2)</span>
<span id="cb1-40"><a href="#cb1-40"></a>    </span>
<span id="cb1-41"><a href="#cb1-41"></a>    d_add <span class="op">=</span> decrypt(c_add, p, q) <span class="co">#14</span></span>
<span id="cb1-42"><a href="#cb1-42"></a>    d_mult <span class="op">=</span> decrypt(c_mult, p, q)</span>
<span id="cb1-43"><a href="#cb1-43"></a>    </span>
<span id="cb1-44"><a href="#cb1-44"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Homomorphic Addition: </span><span class="sc">{</span>m1<span class="sc">}</span><span class="ss"> + </span><span class="sc">{</span>m2<span class="sc">}</span><span class="ss"> = </span><span class="sc">{</span>d_add<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-45"><a href="#cb1-45"></a>    <span class="bu">print</span>(<span class="ss">f"Homomorphic Multiplication: </span><span class="sc">{</span>m1<span class="sc">}</span><span class="ss"> * </span><span class="sc">{</span>m2<span class="sc">}</span><span class="ss"> = </span><span class="sc">{</span>d_mult<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol type="1">
<li>Required imports for this minimal educational implementation</li>
<li>Function to generate public key n and private keys p, q</li>
<li>Fixed prime for demonstration purposes</li>
<li>Another fixed prime for demonstration</li>
<li>Encrypt a message using public key and random noise</li>
<li>Small fixed range for demonstration purposes</li>
<li>Decrypt a message using private keys p and q</li>
<li>Add two ciphertexts homomorphically</li>
<li>Multiply two ciphertexts homomorphically</li>
<li>Example usage demonstration</li>
<li>Setting up original messages for encryption</li>
<li>Encrypt both messages using the public key</li>
<li>Perform homomorphic operations on encrypted data</li>
<li>Decrypt the results of homomorphic operations</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> random</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="im">from</span> typing <span class="im">import</span> Tuple, Optional</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="im">from</span> math <span class="im">import</span> gcd</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="im">import</span> secrets <span class="co">#1</span></span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="at">@dataclass</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="kw">class</span> KeyPair: <span class="co">#2</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>    public_key: <span class="bu">int</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>    private_p: <span class="bu">int</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>    private_q: <span class="bu">int</span></span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="at">@dataclass</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="kw">class</span> Ciphertext: <span class="co">#3</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>    value: <span class="bu">int</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>    noise_level: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="kw">class</span> FHE: <span class="co">#4</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, security_bits: <span class="bu">int</span> <span class="op">=</span> <span class="dv">8</span>): <span class="co">#5</span></span>
<span id="cb2-20"><a href="#cb2-20"></a>        <span class="va">self</span>.security_bits <span class="op">=</span> security_bits</span>
<span id="cb2-21"><a href="#cb2-21"></a>        <span class="va">self</span>.noise_threshold <span class="op">=</span> <span class="dv">2</span> <span class="op">**</span> (security_bits <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb2-22"><a href="#cb2-22"></a>    </span>
<span id="cb2-23"><a href="#cb2-23"></a>    <span class="kw">def</span> generate_prime(<span class="va">self</span>, bits: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>: <span class="co">#6</span></span>
<span id="cb2-24"><a href="#cb2-24"></a>        <span class="kw">def</span> is_prime(n: <span class="bu">int</span>, k: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>: <span class="co">#7</span></span>
<span id="cb2-25"><a href="#cb2-25"></a>            <span class="cf">if</span> n <span class="op">&lt;</span> <span class="dv">2</span>: <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb2-26"><a href="#cb2-26"></a>            <span class="cf">if</span> n <span class="op">==</span> <span class="dv">2</span>: <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb2-27"><a href="#cb2-27"></a>            <span class="cf">if</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>: <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb2-28"><a href="#cb2-28"></a>            </span>
<span id="cb2-29"><a href="#cb2-29"></a>            r, s <span class="op">=</span> <span class="dv">0</span>, n <span class="op">-</span> <span class="dv">1</span> <span class="co">#8</span></span>
<span id="cb2-30"><a href="#cb2-30"></a>            <span class="cf">while</span> s <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb2-31"><a href="#cb2-31"></a>                r <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-32"><a href="#cb2-32"></a>                s <span class="op">//=</span> <span class="dv">2</span></span>
<span id="cb2-33"><a href="#cb2-33"></a>                </span>
<span id="cb2-34"><a href="#cb2-34"></a>            <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(k): <span class="co">#9</span></span>
<span id="cb2-35"><a href="#cb2-35"></a>                a <span class="op">=</span> random.randrange(<span class="dv">2</span>, n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb2-36"><a href="#cb2-36"></a>                x <span class="op">=</span> <span class="bu">pow</span>(a, s, n)</span>
<span id="cb2-37"><a href="#cb2-37"></a>                <span class="cf">if</span> x <span class="op">==</span> <span class="dv">1</span> <span class="kw">or</span> x <span class="op">==</span> n <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb2-38"><a href="#cb2-38"></a>                    <span class="cf">continue</span></span>
<span id="cb2-39"><a href="#cb2-39"></a>                <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(r <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb2-40"><a href="#cb2-40"></a>                    x <span class="op">=</span> <span class="bu">pow</span>(x, <span class="dv">2</span>, n)</span>
<span id="cb2-41"><a href="#cb2-41"></a>                    <span class="cf">if</span> x <span class="op">==</span> n <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb2-42"><a href="#cb2-42"></a>                        <span class="cf">break</span></span>
<span id="cb2-43"><a href="#cb2-43"></a>                <span class="cf">else</span>:</span>
<span id="cb2-44"><a href="#cb2-44"></a>                    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb2-45"><a href="#cb2-45"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb2-46"><a href="#cb2-46"></a>        </span>
<span id="cb2-47"><a href="#cb2-47"></a>        <span class="cf">while</span> <span class="va">True</span>: <span class="co">#10</span></span>
<span id="cb2-48"><a href="#cb2-48"></a>            candidate <span class="op">=</span> secrets.randbits(bits) <span class="op">|</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> (bits <span class="op">-</span> <span class="dv">1</span>)) <span class="op">|</span> <span class="dv">1</span></span>
<span id="cb2-49"><a href="#cb2-49"></a>            <span class="cf">if</span> is_prime(candidate):</span>
<span id="cb2-50"><a href="#cb2-50"></a>                <span class="cf">return</span> candidate</span>
<span id="cb2-51"><a href="#cb2-51"></a></span>
<span id="cb2-52"><a href="#cb2-52"></a>    <span class="kw">def</span> generate_keys(<span class="va">self</span>) <span class="op">-&gt;</span> KeyPair: <span class="co">#11</span></span>
<span id="cb2-53"><a href="#cb2-53"></a>        p <span class="op">=</span> <span class="va">self</span>.generate_prime(<span class="va">self</span>.security_bits)</span>
<span id="cb2-54"><a href="#cb2-54"></a>        q <span class="op">=</span> <span class="va">self</span>.generate_prime(<span class="va">self</span>.security_bits)</span>
<span id="cb2-55"><a href="#cb2-55"></a>        <span class="cf">while</span> p <span class="op">==</span> q:</span>
<span id="cb2-56"><a href="#cb2-56"></a>            q <span class="op">=</span> <span class="va">self</span>.generate_prime(<span class="va">self</span>.security_bits)</span>
<span id="cb2-57"><a href="#cb2-57"></a>            </span>
<span id="cb2-58"><a href="#cb2-58"></a>        <span class="cf">return</span> KeyPair(</span>
<span id="cb2-59"><a href="#cb2-59"></a>            public_key<span class="op">=</span>p <span class="op">*</span> q,</span>
<span id="cb2-60"><a href="#cb2-60"></a>            private_p<span class="op">=</span>p,</span>
<span id="cb2-61"><a href="#cb2-61"></a>            private_q<span class="op">=</span>q</span>
<span id="cb2-62"><a href="#cb2-62"></a>        )</span>
<span id="cb2-63"><a href="#cb2-63"></a>    </span>
<span id="cb2-64"><a href="#cb2-64"></a>    <span class="kw">def</span> encrypt(<span class="va">self</span>, plaintext: <span class="bu">int</span>, public_key: <span class="bu">int</span>) <span class="op">-&gt;</span> Ciphertext: <span class="co">#12</span></span>
<span id="cb2-65"><a href="#cb2-65"></a>        <span class="cf">if</span> plaintext <span class="op">&gt;=</span> public_key:</span>
<span id="cb2-66"><a href="#cb2-66"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Plaintext must be smaller than public key"</span>)</span>
<span id="cb2-67"><a href="#cb2-67"></a>            </span>
<span id="cb2-68"><a href="#cb2-68"></a>        noise <span class="op">=</span> secrets.randbelow(<span class="va">self</span>.noise_threshold)</span>
<span id="cb2-69"><a href="#cb2-69"></a>        <span class="cf">return</span> Ciphertext(</span>
<span id="cb2-70"><a href="#cb2-70"></a>            value<span class="op">=</span>plaintext <span class="op">+</span> noise <span class="op">*</span> public_key,</span>
<span id="cb2-71"><a href="#cb2-71"></a>            noise_level<span class="op">=</span><span class="dv">1</span></span>
<span id="cb2-72"><a href="#cb2-72"></a>        )</span>
<span id="cb2-73"><a href="#cb2-73"></a>    </span>
<span id="cb2-74"><a href="#cb2-74"></a>    <span class="kw">def</span> decrypt(<span class="va">self</span>, ciphertext: Ciphertext, keys: KeyPair) <span class="op">-&gt;</span> <span class="bu">int</span>: <span class="co">#13</span></span>
<span id="cb2-75"><a href="#cb2-75"></a>        <span class="cf">if</span> ciphertext.noise_level <span class="op">&gt;=</span> <span class="va">self</span>.noise_threshold:</span>
<span id="cb2-76"><a href="#cb2-76"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Noise level too high - decryption may be incorrect"</span>)</span>
<span id="cb2-77"><a href="#cb2-77"></a>            </span>
<span id="cb2-78"><a href="#cb2-78"></a>        <span class="cf">return</span> ciphertext.value <span class="op">%</span> keys.public_key</span>
<span id="cb2-79"><a href="#cb2-79"></a>    </span>
<span id="cb2-80"><a href="#cb2-80"></a>    <span class="kw">def</span> homomorphic_add(<span class="va">self</span>, c1: Ciphertext, c2: Ciphertext) <span class="op">-&gt;</span> Ciphertext: <span class="co">#14</span></span>
<span id="cb2-81"><a href="#cb2-81"></a>        <span class="cf">return</span> Ciphertext(</span>
<span id="cb2-82"><a href="#cb2-82"></a>            value<span class="op">=</span>c1.value <span class="op">+</span> c2.value,</span>
<span id="cb2-83"><a href="#cb2-83"></a>            noise_level<span class="op">=</span><span class="bu">max</span>(c1.noise_level, c2.noise_level) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb2-84"><a href="#cb2-84"></a>        )</span>
<span id="cb2-85"><a href="#cb2-85"></a>    </span>
<span id="cb2-86"><a href="#cb2-86"></a>    <span class="kw">def</span> homomorphic_multiply(<span class="va">self</span>, c1: Ciphertext, c2: Ciphertext) <span class="op">-&gt;</span> Ciphertext: <span class="co">#15</span></span>
<span id="cb2-87"><a href="#cb2-87"></a>        <span class="cf">return</span> Ciphertext(</span>
<span id="cb2-88"><a href="#cb2-88"></a>            value<span class="op">=</span>c1.value <span class="op">*</span> c2.value,</span>
<span id="cb2-89"><a href="#cb2-89"></a>            noise_level<span class="op">=</span>c1.noise_level <span class="op">+</span> c2.noise_level <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb2-90"><a href="#cb2-90"></a>        )</span>
<span id="cb2-91"><a href="#cb2-91"></a></span>
<span id="cb2-92"><a href="#cb2-92"></a><span class="kw">def</span> demonstrate_refined_fhe(): <span class="co">#16</span></span>
<span id="cb2-93"><a href="#cb2-93"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">=== Refined FHE Demo ==="</span>)</span>
<span id="cb2-94"><a href="#cb2-94"></a>    </span>
<span id="cb2-95"><a href="#cb2-95"></a>    fhe <span class="op">=</span> FHE(security_bits<span class="op">=</span><span class="dv">8</span>) <span class="co">#17</span></span>
<span id="cb2-96"><a href="#cb2-96"></a>    </span>
<span id="cb2-97"><a href="#cb2-97"></a>    keys <span class="op">=</span> fhe.generate_keys() <span class="co">#18</span></span>
<span id="cb2-98"><a href="#cb2-98"></a>    public_key <span class="op">=</span> keys.public_key</span>
<span id="cb2-99"><a href="#cb2-99"></a>    p, q <span class="op">=</span> keys.private_p, keys.private_q</span>
<span id="cb2-100"><a href="#cb2-100"></a>    </span>
<span id="cb2-101"><a href="#cb2-101"></a>    <span class="bu">print</span>(<span class="ss">f"Keys - Public: </span><span class="sc">{</span>public_key<span class="sc">}</span><span class="ss">, Private: (p=</span><span class="sc">{</span>p<span class="sc">}</span><span class="ss">, q=</span><span class="sc">{</span>q<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb2-102"><a href="#cb2-102"></a>    </span>
<span id="cb2-103"><a href="#cb2-103"></a>    m1, m2 <span class="op">=</span> <span class="dv">3</span>, <span class="dv">4</span> <span class="co">#19</span></span>
<span id="cb2-104"><a href="#cb2-104"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Original messages: m1=</span><span class="sc">{</span>m1<span class="sc">}</span><span class="ss">, m2=</span><span class="sc">{</span>m2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-105"><a href="#cb2-105"></a>    </span>
<span id="cb2-106"><a href="#cb2-106"></a>    c1 <span class="op">=</span> fhe.encrypt(m1, public_key) <span class="co">#20</span></span>
<span id="cb2-107"><a href="#cb2-107"></a>    c2 <span class="op">=</span> fhe.encrypt(m2, public_key)</span>
<span id="cb2-108"><a href="#cb2-108"></a>    <span class="bu">print</span>(<span class="ss">f"Encrypted messages: c1=</span><span class="sc">{</span>c1<span class="sc">.</span>value<span class="sc">}</span><span class="ss">, c2=</span><span class="sc">{</span>c2<span class="sc">.</span>value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-109"><a href="#cb2-109"></a>    </span>
<span id="cb2-110"><a href="#cb2-110"></a>    c_add <span class="op">=</span> fhe.homomorphic_add(c1, c2) <span class="co">#21</span></span>
<span id="cb2-111"><a href="#cb2-111"></a>    c_mult <span class="op">=</span> fhe.homomorphic_multiply(c1, c2)</span>
<span id="cb2-112"><a href="#cb2-112"></a>    </span>
<span id="cb2-113"><a href="#cb2-113"></a>    d_add <span class="op">=</span> fhe.decrypt(c_add, keys) <span class="co">#22</span></span>
<span id="cb2-114"><a href="#cb2-114"></a>    d_mult <span class="op">=</span> fhe.decrypt(c_mult, keys)</span>
<span id="cb2-115"><a href="#cb2-115"></a>    </span>
<span id="cb2-116"><a href="#cb2-116"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Homomorphic Addition: </span><span class="sc">{</span>m1<span class="sc">}</span><span class="ss"> + </span><span class="sc">{</span>m2<span class="sc">}</span><span class="ss"> = </span><span class="sc">{</span>d_add<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-117"><a href="#cb2-117"></a>    <span class="bu">print</span>(<span class="ss">f"Homomorphic Multiplication: </span><span class="sc">{</span>m1<span class="sc">}</span><span class="ss"> * </span><span class="sc">{</span>m2<span class="sc">}</span><span class="ss"> = </span><span class="sc">{</span>d_mult<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-118"><a href="#cb2-118"></a>    <span class="bu">print</span>(<span class="ss">f"Noise levels - Addition: </span><span class="sc">{</span>c_add<span class="sc">.</span>noise_level<span class="sc">}</span><span class="ss">, Multiplication: </span><span class="sc">{</span>c_mult<span class="sc">.</span>noise_level<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol type="1">
<li>Required imports including secure random number generation</li>
<li>Container class for storing cryptographic key pairs</li>
<li>Container class for encrypted data with noise tracking</li>
<li>More complete somewhat homomorphic encryption implementation with better security</li>
<li>Initialize FHE system with specified security parameter</li>
<li>Generate a prime number of specified bit length</li>
<li>Miller-Rabin primality test implementation</li>
<li>Find odd part of n-1 for Miller-Rabin test</li>
<li>Perform k rounds of Miller-Rabin testing</li>
<li>Generate random candidate and test for primality</li>
<li>Generate public and private keys using secure prime generation</li>
<li>Encrypt a message using public key and controlled noise</li>
<li>Decrypt a message using private keys with noise level check</li>
<li>Add two ciphertexts homomorphically while tracking noise</li>
<li>Multiply two ciphertexts homomorphically while tracking noise</li>
<li>Demonstration of the refined FHE implementation</li>
<li>Initialize FHE system with 8-bit security parameter</li>
<li>Generate and extract key components</li>
<li>Set up test messages for demonstration</li>
<li>Encrypt test messages with noise tracking</li>
<li>Perform homomorphic operations on encrypted data</li>
<li>Decrypt results and display noise levels</li>
</ol>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/antomon\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Antonio Montano’s Personal Website</p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="./about.html">
<p>About</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="./contents/services.html">
<p>Services</p>
</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/montano/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/antomon">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/antomon">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © Antonio Montano, 2024
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">
<p><img src="https://raw.githubusercontent.com/antomon/antomon.github.io/cd7dbf5f81371c6eb1c3c7e8a32ac35f44b3bbce/by-nc-nd.svg" class="img-fluid"></p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>