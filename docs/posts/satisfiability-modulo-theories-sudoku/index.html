<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Antonio Montano">
<meta name="dcterms.date" content="2024-09-05">
<meta name="description" content="This post explores the fundamental concepts of SAT (Boolean Satisfiability Problem) and SMT (Satisfiability Modulo Theories), which are key tools in computer science for solving complex logical and mathematical problems. SAT focuses on determining whether there exists a True/False assignment to variables that satisfies a logical formula, while SMT extends this by incorporating additional mathematical structures like integers, arrays, and functions. We will delve into how these tools are used in real-world applications such as hardware verification, AI, and optimization, and conclude with a practical example of using SMT to solve Sudoku puzzles, demonstrating the problem-solving power of these techniques.">

<title>Sudoku and Satisfiability Modulo Theories ‚Äì Antonio Montano‚Äôs Personal Website</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=663ff7b280d7c0001914e592&amp;product=sticky-share-buttons" async="async"></script>
<script src="https://cdn.jsdelivr.net/npm/typewriter-effect@latest/dist/core.js"></script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Sudoku and Satisfiability Modulo Theories ‚Äì Antonio Montano‚Äôs Personal Website">
<meta property="og:description" content="This post explores the fundamental concepts of SAT (Boolean Satisfiability Problem) and SMT (Satisfiability Modulo Theories), which are key tools in computer science for solving complex logical and mathematical problems. SAT focuses on determining whether there exists a True/False assignment to variables that satisfies a logical formula, while SMT extends this by incorporating additional mathematical structures like integers, arrays, and functions. We will delve into how these tools are used in real-world applications such as hardware verification, AI, and optimization, and conclude with a practical example of using SMT to solve Sudoku puzzles, demonstrating the problem-solving power of these techniques.">
<meta property="og:image" content="https://antomon.github.io/posts/satisfiability-modulo-theories-sudoku/smt-sudoku.webp">
<meta property="og:site_name" content="Antonio Montano's Personal Website">
<meta name="twitter:title" content="Sudoku and Satisfiability Modulo Theories ‚Äì Antonio Montano‚Äôs Personal Website">
<meta name="twitter:description" content="This post explores the fundamental concepts of SAT (Boolean Satisfiability Problem) and SMT (Satisfiability Modulo Theories), which are key tools in computer science for solving complex logical and mathematical problems. SAT focuses on determining whether there exists a True/False assignment to variables that satisfies a logical formula, while SMT extends this by incorporating additional mathematical structures like integers, arrays, and functions. We will delve into how these tools are used in real-world applications such as hardware verification, AI, and optimization, and conclude with a practical example of using SMT to solve Sudoku puzzles, demonstrating the problem-solving power of these techniques.">
<meta name="twitter:image" content="https://antomon.github.io/posts/satisfiability-modulo-theories-sudoku/smt-sudoku.webp">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../favicon.png" alt="AM logo" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Antonio Montano‚Äôs Personal Website</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contents/services.html"> 
<span class="menu-text">Services</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://4m4.it/corso-python/"> 
<span class="menu-text">Corso Python</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/montano/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/antomon"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/antomon"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Sudoku and Satisfiability Modulo Theories</h1>
        </a>     
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block">Sudoku and Satisfiability Modulo Theories</h1>
            <p class="subtitle lead">You can solve it the standard way or‚Ä¶ with Python amd math</p>
                  <div>
        <div class="description">
          This post explores the fundamental concepts of SAT (Boolean Satisfiability Problem) and SMT (Satisfiability Modulo Theories), which are key tools in computer science for solving complex logical and mathematical problems. SAT focuses on determining whether there exists a True/False assignment to variables that satisfies a logical formula, while SMT extends this by incorporating additional mathematical structures like integers, arrays, and functions. We will delve into how these tools are used in real-world applications such as hardware verification, AI, and optimization, and conclude with a practical example of using SMT to solve Sudoku puzzles, demonstrating the problem-solving power of these techniques.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">fun</div>
                <div class="quarto-category">mathematics</div>
                <div class="quarto-category">Python</div>
                <div class="quarto-category">üá¨üáß</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Antonio Montano </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 5, 2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">September 5, 2024</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">All posts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/category-theory-functional-programming/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Relationship Between Category Theory, Lambda Calculus, and Functional Programming in Haskell</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/satisfiability-modulo-theories-sudoku/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Sudoku and Satisfiability Modulo Theories</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ai-important-as-fire/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AI important as fire, generative AI as printing press, autonomous agents as wheel?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/color-space-sampling-101/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Color Space Sampling 101</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/attentions/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Harnessing Focus: Merging AI and Market Dynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/gpt-4-anniversary/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GPT-4 Anniversary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/intervento-dabs-day-2024-ca-foscari/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intervento al DABS Day 2024 - Universit√† Ca‚Äô Foscari</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#sat" id="toc-sat" class="nav-link" data-scroll-target="#sat">SAT</a>
  <ul class="collapse">
  <li><a href="#propositional-logic" id="toc-propositional-logic" class="nav-link" data-scroll-target="#propositional-logic">Propositional logic</a></li>
  <li><a href="#decision-problems" id="toc-decision-problems" class="nav-link" data-scroll-target="#decision-problems">Decision problems</a></li>
  <li><a href="#standardizing-sat-problems" id="toc-standardizing-sat-problems" class="nav-link" data-scroll-target="#standardizing-sat-problems">Standardizing SAT problems</a></li>
  <li><a href="#np-complete-problems" id="toc-np-complete-problems" class="nav-link" data-scroll-target="#np-complete-problems">NP-complete problems</a></li>
  <li><a href="#sat-solvers-how-do-they-work" id="toc-sat-solvers-how-do-they-work" class="nav-link" data-scroll-target="#sat-solvers-how-do-they-work">SAT solvers: how do they work?</a></li>
  <li><a href="#real-world-applications" id="toc-real-world-applications" class="nav-link" data-scroll-target="#real-world-applications">Real-world applications</a></li>
  </ul></li>
  <li><a href="#smt" id="toc-smt" class="nav-link" data-scroll-target="#smt">SMT</a>
  <ul class="collapse">
  <li><a href="#theories" id="toc-theories" class="nav-link" data-scroll-target="#theories">Theories</a></li>
  <li><a href="#how-smt-solvers-work" id="toc-how-smt-solvers-work" class="nav-link" data-scroll-target="#how-smt-solvers-work">How SMT solvers work</a></li>
  <li><a href="#complexity" id="toc-complexity" class="nav-link" data-scroll-target="#complexity">Complexity</a></li>
  <li><a href="#why-smt-is-powerful" id="toc-why-smt-is-powerful" class="nav-link" data-scroll-target="#why-smt-is-powerful">Why SMT is powerful</a></li>
  <li><a href="#real-world-applications-1" id="toc-real-world-applications-1" class="nav-link" data-scroll-target="#real-world-applications-1">Real-world applications</a></li>
  <li><a href="#efficiency-and-scalability-of-smt-solvers" id="toc-efficiency-and-scalability-of-smt-solvers" class="nav-link" data-scroll-target="#efficiency-and-scalability-of-smt-solvers">Efficiency and scalability of SMT solvers</a></li>
  <li><a href="#combining-multiple-theories" id="toc-combining-multiple-theories" class="nav-link" data-scroll-target="#combining-multiple-theories">Combining multiple theories</a></li>
  <li><a href="#verifying-software-with-mixed-data-types" id="toc-verifying-software-with-mixed-data-types" class="nav-link" data-scroll-target="#verifying-software-with-mixed-data-types">Verifying software with mixed data types</a></li>
  <li><a href="#a-coordinated-process" id="toc-a-coordinated-process" class="nav-link" data-scroll-target="#a-coordinated-process">A coordinated process</a></li>
  <li><a href="#flexibility-across-domains" id="toc-flexibility-across-domains" class="nav-link" data-scroll-target="#flexibility-across-domains">Flexibility across domains</a></li>
  </ul></li>
  <li><a href="#z3" id="toc-z3" class="nav-link" data-scroll-target="#z3">Z3</a>
  <ul class="collapse">
  <li><a href="#key-features" id="toc-key-features" class="nav-link" data-scroll-target="#key-features">Key features</a></li>
  </ul></li>
  <li><a href="#sudoku-time" id="toc-sudoku-time" class="nav-link" data-scroll-target="#sudoku-time">Sudoku time!</a>
  <ul class="collapse">
  <li><a href="#x9-size" id="toc-x9-size" class="nav-link" data-scroll-target="#x9-size">9x9 size</a></li>
  <li><a href="#some-improvements" id="toc-some-improvements" class="nav-link" data-scroll-target="#some-improvements">Some improvements</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Imagine you‚Äôre trying to solve a puzzle where you have to figure out whether certain statements can all be true at the same time. This might sound simple, but what if those statements involve complex rules and relationships? Problems like these are at the heart of <strong>SAT (Boolean Satisfiability Problem)</strong> and <strong>SMT (Satisfiability Modulo Theories)</strong>, two important topics in computer science and logic. They help us solve complex puzzles in many areas, from designing computer chips to scheduling tasks. This essay will explore what SAT and SMT are, why they matter, and how they are used in real-world situations.</p>
<p>As a fun and practical example of how these tools can be used, we‚Äôll end this post by showing how SMT can be used to solve Sudoku puzzles, turning a well-known puzzle into a logic-based problem-solving task.</p>
</section>
<section id="sat" class="level2">
<h2 class="anchored" data-anchor-id="sat">SAT</h2>
<p><strong>SAT</strong> stands for <strong>Boolean Satisfiability Problem</strong>. It‚Äôs all about answering a basic question: <em>‚ÄúCan we assign True or False values to certain variables in a way that makes a given logical formula true?‚Äù</em></p>
<p>Think of SAT as a logic puzzle. Here‚Äôs an example:</p>
<p>You‚Äôre given the statements:</p>
<ol type="1">
<li><p><span class="math inline">x</span> or <span class="math inline">y</span> (meaning one of them, or both, must be True).</p></li>
<li><p>Not <span class="math inline">x</span> or <span class="math inline">z</span> (meaning either <span class="math inline">x</span> is False, or <span class="math inline">z</span> is True, or both).</p></li>
<li><p>Not <span class="math inline">y</span> or not <span class="math inline">z</span> (meaning at least one of <span class="math inline">y</span> or <span class="math inline">z</span> must be False).</p></li>
</ol>
<p>Can you assign True or False values to <span class="math inline">x</span>, <span class="math inline">y</span>, and <span class="math inline">z</span> that make all of these statements true at the same time?</p>
<p>This is a SAT problem! The goal is to find a solution where the statements don‚Äôt contradict each other, or determine if no such solution exists.</p>
<section id="propositional-logic" class="level3">
<h3 class="anchored" data-anchor-id="propositional-logic">Propositional logic</h3>
<p><strong>Propositional logic</strong>, also known as <strong>Boolean logic</strong>, deals with statements that can either be <strong>True</strong> or <strong>False</strong>. These statements are called <strong>propositions</strong>, and they are combined using logical operators to form <strong>propositional logic formulas</strong>.</p>
<p>A <strong>proposition</strong> is a statement that has a definite truth value‚Äîeither True or False. For example:</p>
<ul>
<li><p>‚ÄúIt is raining‚Äù is a proposition, and it can be either True or False.</p></li>
<li><p>In mathematical terms, we often use <strong>variables</strong> to represent propositions. For example, we might let:</p>
<ul>
<li><p><span class="math inline">x</span> represent ‚ÄúIt is raining‚Äù.</p></li>
<li><p><span class="math inline">y</span> represent ‚ÄúIt is cloudy‚Äù.</p></li>
</ul></li>
</ul>
<p>Each of these variables can take the value True or False.</p>
<p>In propositional logic, we use <strong>logical operators</strong> to combine propositions into more complex formulas. The most important operators are:</p>
<ul>
<li><p><strong>AND ( ‚àß )</strong>: The expression <span class="math inline">x \land y</span> is True only if both <span class="math inline">x</span> and <span class="math inline">y</span> are True. Example: ‚ÄúIt is raining <strong>and</strong> it is cloudy‚Äù is only True if both things are happening.</p></li>
<li><p><strong>OR ( ‚à® )</strong>: The expression <span class="math inline">x \lor y</span> is True if either <span class="math inline">x</span> or <span class="math inline">y</span> (or both) are True. Example: ‚ÄúIt is raining <strong>or</strong> it is cloudy‚Äù is True if at least one of them is happening.</p></li>
<li><p><strong>NOT ( ¬¨ )</strong>: The expression <span class="math inline">\neg x</span> (read as ‚Äúnot <span class="math inline">x</span>‚Äù) is True if <span class="math inline">x</span> is False. Example: ‚ÄúIt is <strong>not</strong> raining‚Äù is True if <span class="math inline">x</span> is False (i.e., it is not raining).</p></li>
<li><p><strong>Implication ( ‚Üí )</strong>: The expression <span class="math inline">x \rightarrow y</span> (read as ‚Äúif <span class="math inline">x</span>, then <span class="math inline">y</span>‚Äù) is True unless <span class="math inline">x</span> is True and <span class="math inline">y</span> is False. Example: ‚ÄúIf it is raining, then it is cloudy‚Äù is True unless it‚Äôs raining but not cloudy.</p></li>
</ul>
<p>A <strong>propositional logic formula</strong> is a combination of variables and logical operators that can be evaluated as True or False, depending on the values of the variables.</p>
<p>For example, consider the formula:</p>
<p><span class="math display">
(x \lor y) \land (\neg x \lor z)
</span></p>
<p>This formula combines the variables <span class="math inline">x</span>, <span class="math inline">y</span>, and <span class="math inline">z</span> using the logical operators AND, OR, and NOT. The task is to determine whether there are values for <span class="math inline">x</span>, <span class="math inline">y</span>, and <span class="math inline">z</span> that make the whole formula True. This is exactly what the SAT problem asks us to solve.</p>
</section>
<section id="decision-problems" class="level3">
<h3 class="anchored" data-anchor-id="decision-problems">Decision problems</h3>
<p>A <strong>decision problem</strong> is a question that can be answered with a simple <strong>Yes</strong> or <strong>No</strong>. In the case of SAT, the decision problem is:</p>
<p><em>‚ÄúGiven a propositional logic formula, is there an assignment of True/False values to the variables that makes the formula True?‚Äù</em></p>
<p>If such an assignment exists, the answer is <strong>Yes</strong>, and we say the formula is <strong>satisfiable</strong>. If no such assignment exists, the answer is <strong>No</strong>, and we say the formula is <strong>unsatisfiable</strong>.</p>
<p>Let‚Äôs consider a simple SAT problem:</p>
<p><span class="math display">
(x \lor y) \land (\neg x \lor z) \land (\neg y \lor \neg z)
</span></p>
<p>We want to know if there‚Äôs a way to assign True or False values to <span class="math inline">x</span>, <span class="math inline">y</span>, and <span class="math inline">z</span> so that the entire formula is True.</p>
<p>Let‚Äôs try a few combinations:</p>
<ul>
<li><p>If <span class="math inline">x = \mathrm{True}, y = \mathrm{True}, z = \mathrm{True}</span>: <span class="math inline">(x \lor y)</span> is <span class="math inline">\mathrm{True}</span>, <span class="math inline">(\neg x \lor z)</span> is <span class="math inline">\mathrm{True}</span>, but <span class="math inline">(\neg y \lor \neg z)</span> is <span class="math inline">\mathrm{False}</span>. This assignment does <strong>not</strong> satisfy the formula.</p></li>
<li><p>If <span class="math inline">x = \mathrm{True}, y = \mathrm{False}, z = \mathrm{True}</span>: <span class="math inline">(x \lor y)</span> is <span class="math inline">\mathrm{True}</span>, <span class="math inline">(\neg x \lor z)</span> is <span class="math inline">\mathrm{True}</span>, and <span class="math inline">(\neg y \lor \neg z)</span> is <span class="math inline">\mathrm{True}</span>. This assignment <strong>does</strong> satisfy the formula!</p></li>
</ul>
<p>So, the formula is satisfiable, and the answer to the SAT problem is Yes.</p>
</section>
<section id="standardizing-sat-problems" class="level3">
<h3 class="anchored" data-anchor-id="standardizing-sat-problems">Standardizing SAT problems</h3>
<p>Many SAT problems are written in a special format called <strong>Conjunctive Normal Form (CNF)</strong>. A formula is in CNF if it is a conjunction (AND) of one or more <strong>clauses</strong>, where each clause is a disjunction (OR) of <strong>literals</strong>. A literal is simply a variable or its negation.</p>
<p>For example, the formula:</p>
<p><span class="math display">
(x \lor \neg y) \land (\neg x \lor z \lor y)
</span></p>
<p>is in CNF because it is an AND of two OR clauses.</p>
<p>Why is CNF important? SAT solvers (programs designed to solve SAT problems) work more efficiently when the formula is in CNF. In fact, any propositional logic formula can be converted into CNF without changing its satisfiability.</p>
</section>
<section id="np-complete-problems" class="level3">
<h3 class="anchored" data-anchor-id="np-complete-problems">NP-complete problems</h3>
<p><strong>SAT is the first problem ever proven to be NP-complete.</strong> This means that:</p>
<ol type="1">
<li><p><strong>SAT is in NP</strong>: Given a solution (an assignment of True/False values), we can check if it satisfies the formula in a reasonable amount of time (in polynomial time).</p></li>
<li><p><strong>SAT is NP-hard</strong>: Every problem in NP can be reduced to SAT in polynomial time. In simpler terms, if we can solve SAT quickly, we can solve every problem in NP quickly.</p></li>
</ol>
<p>This discovery has huge implications in computer science because it shows how SAT is connected to many other difficult problems. If we can find an efficient algorithm to solve SAT, we can apply it to a wide range of important problems, like optimization, scheduling, and even cryptography.</p>
</section>
<section id="sat-solvers-how-do-they-work" class="level3">
<h3 class="anchored" data-anchor-id="sat-solvers-how-do-they-work">SAT solvers: how do they work?</h3>
<p>SAT problems can get very complicated, especially when there are many variables and clauses. To solve them efficiently, we use <strong>SAT solvers</strong>, which are computer programs designed to find solutions to SAT problems. SAT solvers use several smart strategies to speed up the search for a solution. Two of the most common strategies are:</p>
<ul>
<li><p><strong>Backtracking</strong>: The solver tries different assignments of True/False values, and if it hits a dead end (an unsatisfiable assignment), it backtracks and tries a different path.</p></li>
<li><p><strong>Unit propagation</strong>: If a clause contains only one unassigned variable, the solver can immediately assign it a value that satisfies the clause.</p></li>
</ul>
<p>Modern SAT solvers can solve problems with thousands or even millions of variables and clauses. These solvers are used in many applications, including verifying that hardware circuits work correctly and solving complex puzzles like Sudoku.</p>
</section>
<section id="real-world-applications" class="level3">
<h3 class="anchored" data-anchor-id="real-world-applications">Real-world applications</h3>
<p>Now that we know what SAT is, let‚Äôs explore some real-world uses:</p>
<ul>
<li><p><strong>Hardware and software verification</strong>: Before building a computer chip, engineers use SAT to check that the design behaves correctly. A mistake in the design could cause a computer to crash or malfunction. SAT solvers help catch these errors before they become costly problems. Similarly, SAT is used in software verification to ensure that a program behaves as expected under all possible conditions.</p></li>
<li><p><strong>AI and decision making</strong>: In artificial intelligence (AI), SAT is used to solve planning and decision-making problems. For example, SAT can help an AI system figure out the best sequence of actions to achieve a goal while following certain rules.</p></li>
<li><p><strong>Puzzles and games</strong>: Many logic-based puzzles, like Sudoku or Minesweeper, can be turned into SAT problems. A SAT solver can then be used to find the solution to the puzzle, or to check if the puzzle has a unique solution.</p></li>
</ul>
</section>
</section>
<section id="smt" class="level2">
<h2 class="anchored" data-anchor-id="smt">SMT</h2>
<p>Now that we have a solid understanding of <strong>SAT</strong> and how it helps us solve problems using <strong>propositional logic</strong> (True/False values), let‚Äôs take things a step further with <strong>SMT</strong>, or <strong>Satisfiability Modulo Theories</strong>. While SAT focuses only on whether a logical formula can be true or false, SMT opens the door to solving more complex mathematical problems that involve numbers, functions, arrays, and even more abstract concepts. SMT combines the power of SAT with other <strong>theories</strong> from mathematics to tackle a wider range of problems.</p>
<p>Like SAT, SMT asks whether a certain formula can be made True, but it doesn‚Äôt limit itself to just logical variables (True/False values). Instead, SMT allows us to work with <strong>mathematical objects</strong> like:</p>
<ul>
<li><p><strong>Integers</strong> (whole numbers).</p></li>
<li><p><strong>Real numbers</strong> (including fractions and decimals).</p></li>
<li><p><strong>Arrays</strong> (lists of elements).</p></li>
<li><p><strong>Functions</strong> (mathematical relationships).</p></li>
</ul>
<p>With SMT, we can ask questions that involve not just logic but also arithmetic, like: ‚ÄúIs there a way to assign values to <span class="math inline">x</span> and <span class="math inline">y</span> such that <span class="math inline">x + y = 5</span> and <span class="math inline">x &gt; 2</span>?‚Äù</p>
<p>In this case, <span class="math inline">x</span> and <span class="math inline">y</span> are not just True or False; they are numbers. SMT solvers, just like SAT solvers, try to find values for the variables that satisfy all the given conditions.</p>
<section id="theories" class="level3">
<h3 class="anchored" data-anchor-id="theories">Theories</h3>
<p>In SMT, the word <strong>theory</strong> refers to a set of rules that describe how certain kinds of mathematical objects behave. These theories help the SMT solver understand and solve problems that go beyond simple logic. Let‚Äôs take a look at some common theories used in SMT:</p>
<ul>
<li><p><strong>Linear arithmetic</strong>: This theory deals with equations and inequalities involving numbers. It allows us to solve problems like:</p>
<ul>
<li><p><span class="math inline">x + y = 10</span>.</p></li>
<li><p><span class="math inline">3x - 2y \leq 5</span>.</p></li>
<li><p><span class="math inline">x \geq 0</span>.</p></li>
</ul></li>
</ul>
<p>The SMT solver uses the rules of arithmetic to find values for <span class="math inline">x</span> and <span class="math inline">y</span> that satisfy these equations.</p>
<ul>
<li><p><strong>Bit-vectors</strong>: Bit-vectors represent numbers in <strong>binary form</strong> (0s and 1s), which is how computers store and manipulate data. Bit-vector theory is important in verifying how computer hardware (like circuits) works. For example:</p>
<ul>
<li><p><span class="math inline">x \&amp; y = 1</span>.</p></li>
<li><p><span class="math inline">x \text{ shifted left by } 2 = z</span>.</p></li>
</ul>
<p>These operations are common in low-level computing tasks, and SMT solvers can handle them by using the rules of bit-wise operations.</p></li>
<li><p><strong>Arrays and functions</strong>: Arrays are lists of numbers or objects, and functions describe how inputs are mapped to outputs. SMT solvers can reason about arrays and functions using logical and mathematical rules. For example, in array theory, you might ask: ‚ÄúIs there a way to assign values to an array such that the sum of all its elements is 20?‚Äù, or in function theory: ‚ÄúIs there a function <span class="math inline">f(x)</span> that satisfies <span class="math inline">f(2) = 4</span> and <span class="math inline">f(3) = 9</span>?‚Äù.</p></li>
</ul>
</section>
<section id="how-smt-solvers-work" class="level3">
<h3 class="anchored" data-anchor-id="how-smt-solvers-work">How SMT solvers work</h3>
<p>SMT solvers work in two main steps:</p>
<ol type="1">
<li><p><strong>Boolean abstraction</strong>: The solver first treats the problem as a SAT problem by working with the Boolean logic part. It temporarily ignores the complicated mathematical parts (like numbers or arrays) and focuses on the logical structure.</p></li>
<li><p><strong>Theory solving</strong>: After the SAT part is solved, the SMT solver checks if the numbers, arrays, or functions meet the additional constraints defined by the theory. If the SAT part leads to a solution that violates the mathematical rules (e.g., if the solution says <span class="math inline">x + y = 10</span> but the theory says that‚Äôs not possible), the solver tries a different assignment.</p></li>
</ol>
<p>This combination of logical reasoning (like in SAT) and mathematical reasoning (using theories) makes SMT solvers extremely powerful.</p>
</section>
<section id="complexity" class="level3">
<h3 class="anchored" data-anchor-id="complexity">Complexity</h3>
<p><strong>SMT is NP-hard</strong>, meaning it is at least as hard as the hardest problems in <strong>NP</strong>. This is important because many real-world problems can be formulated as SMT problems, and solving them efficiently is difficult. Like SAT, SMT involves searching through many possible assignments for variables, but in addition to simple logic, the solver must also deal with more complex mathematical theories (such as arithmetic or arrays).</p>
<p>This makes SMT harder to solve than pure SAT problems because the solver not only needs to find a logical assignment but also ensure that it satisfies the rules of the mathematical theory involved. Despite this complexity, SMT solvers have become incredibly advanced and are used in many real-world applications.</p>
</section>
<section id="why-smt-is-powerful" class="level3">
<h3 class="anchored" data-anchor-id="why-smt-is-powerful">Why SMT is powerful</h3>
<p>While <strong>SAT</strong> is a powerful tool for solving logical problems that involve only True/False values, <strong>SMT</strong> goes much further. It combines logic with mathematics, allowing us to solve more complex problems that involve not just logical variables, but also numbers, functions, arrays, and other mathematical structures. By incorporating <strong>theories</strong> such as arithmetic, arrays, and functions, SMT enables us to reason about problems that SAT alone cannot handle.</p>
<p>In a SAT problem, we are limited to determining whether a set of logical conditions can all be true at once, with variables that can only be <strong>True</strong> or <strong>False</strong>. While this is useful in many areas (like circuit verification and puzzle-solving), it doesn‚Äôt account for problems that involve numbers, functions, or more abstract data types.</p>
<p>SMT enhances SAT by allowing us to work with variables that take on more complex values and obey specific rules (or <strong>theories</strong>). This means that SMT can handle problems like:</p>
<ul>
<li><p>Arithmetic: <strong>Finding numbers</strong> that satisfy equations or inequalities.</p></li>
<li><p>Bit-vectors: <strong>Verifying computer hardware</strong> by modeling numbers as binary digits.</p></li>
<li><p>Arrays: <strong>Working with data structures</strong>, such as lists or tables, and reasoning about how elements are stored and accessed.</p></li>
<li><p>Functions: <strong>Handling relationships</strong> between inputs and outputs, which is useful for reasoning about computer programs or mathematical models.</p></li>
</ul>
<p>For example, consider a problem where you need to find two numbers, <span class="math inline">x</span> and <span class="math inline">y</span>, such that:</p>
<ul>
<li><p><span class="math inline">x + y = 10</span>.</p></li>
<li><p><span class="math inline">x &gt; 3</span>.</p></li>
<li><p><span class="math inline">y \leq 6</span>.</p></li>
</ul>
<p>A simple SAT solver cannot deal with this because it only works with True/False values. An SMT solver, however, can use <strong>linear arithmetic theory</strong> to find values for <span class="math inline">x</span> and <span class="math inline">y</span> that satisfy these conditions.</p>
</section>
<section id="real-world-applications-1" class="level3">
<h3 class="anchored" data-anchor-id="real-world-applications-1">Real-world applications</h3>
<p>Because SMT solvers can handle both logic and mathematics, they are used in a wide range of <strong>real-world applications</strong>. These applications often involve problems where both logical conditions and numerical relationships must be satisfied at the same time. Here are a few important areas where SMT solvers play a critical role:</p>
<ul>
<li><p><strong>Verifying computer programs</strong>: In the world of software, programs are expected to behave correctly no matter what inputs they receive or what paths their execution follows. SMT solvers are used to <strong>formally verify</strong> that programs do not crash, run into errors, or behave unexpectedly.</p>
<p>For instance, if you write a program that calculates the square root of a number, you need to make sure it never tries to compute the square root of a negative number (which would cause an error). An SMT solver can check all possible inputs to ensure that the program handles every situation correctly, even the edge cases that a human might miss.</p>
<p>By using SMT, software engineers can catch potential bugs <strong>before</strong> they happen, preventing costly errors in industries like aerospace, medical devices, or financial systems, where software correctness is absolutely critical.</p></li>
<li><p><strong>Solving scheduling problems</strong>: SMT solvers are also used in <strong>scheduling</strong>‚Äîa problem that involves assigning tasks to people, machines, or time slots while following certain rules. These rules might include constraints like:</p>
<ul>
<li><p>A task can only start after another task is finished.</p></li>
<li><p>Some tasks cannot be done at the same time.</p></li>
<li><p>Certain workers are only available at specific times.</p></li>
</ul>
<p>Imagine trying to schedule a series of construction tasks on a large building site. Each task depends on other tasks being completed (you can‚Äôt install the windows before the walls are built!), and you only have a limited number of workers available. SMT solvers can process these constraints and find an <strong>optimal schedule</strong> that minimizes delays and uses resources efficiently.</p>
<p>This ability to handle both logical dependencies and numerical constraints makes SMT invaluable for <strong>resource allocation</strong>, <strong>project planning</strong>, and <strong>logistics</strong> in industries like manufacturing, transportation, and healthcare.</p></li>
<li><p><strong>Optimizing circuit designs</strong>: In hardware design, particularly for computer chips, engineers need to ensure that the circuit behaves correctly under all possible input combinations. This is critical because even a small error can lead to catastrophic consequences, like a computer crashing or malfunctioning. Using <strong>bit-vector theory</strong>, SMT solvers model how circuits manipulate binary data (0s and 1s) and check whether the circuit design meets the required specifications. For example, SMT can verify that:</p>
<ul>
<li><p>A chip correctly adds two numbers without overflow.</p></li>
<li><p>A processor handles all operations within its performance constraints.</p></li>
</ul>
<p>In addition, SMT solvers can <strong>optimize designs</strong> by ensuring that the chip uses the least amount of resources (such as power or space) while still functioning correctly. This makes them indispensable in the <strong>semiconductor industry</strong>, where efficient design is key to building faster, smaller, and more energy-efficient devices.</p></li>
</ul>
</section>
<section id="efficiency-and-scalability-of-smt-solvers" class="level3">
<h3 class="anchored" data-anchor-id="efficiency-and-scalability-of-smt-solvers">Efficiency and scalability of SMT solvers</h3>
<p><strong>SMT solvers</strong> are designed to handle highly complex problems, often involving thousands or even millions of variables and constraints. This capability to scale and manage complexity efficiently is one of the key reasons why SMT solvers have become indispensable in many fields. Unlike simpler solvers that can only handle basic logical formulas, modern SMT solvers‚Äîsuch as Z3 (developed by Microsoft)‚Äîcan work on incredibly large and intricate problems that require the integration of both logic and mathematics.</p>
<section id="large-scale-software-verification" class="level4">
<h4 class="anchored" data-anchor-id="large-scale-software-verification">Large-Scale software verification</h4>
<p>Software verification is a critical application of SMT solvers. Large and complex codebases, like those used in operating systems or flight control software, require guarantees that they behave correctly in every possible situation. This is especially important for <strong>safety-critical systems</strong>, where even a small bug could lead to catastrophic consequences (such as an airplane malfunctioning or a medical device failing). SMT solvers are used to <strong>automatically verify</strong> that a program adheres to its specifications by checking all possible inputs and paths the software might take.</p>
<p>For example, verifying that a piece of software does not crash when it processes certain inputs might require checking billions of different combinations of inputs and internal states. An SMT solver can analyze these possibilities using logical and mathematical models, ensuring that the software behaves as expected across all cases. This process, known as <strong>formal verification</strong>, is a step beyond typical software testing because it proves the absence of errors rather than simply checking for errors that are found during testing.</p>
</section>
<section id="optimizing-systems" class="level4">
<h4 class="anchored" data-anchor-id="optimizing-systems">Optimizing systems</h4>
<p>Another area where SMT solvers excel is <strong>system optimization</strong>. Many real-world systems‚Äîsuch as networks, electronic circuits, or transportation schedules‚Äîare incredibly complex, involving a large number of interacting components that must work together efficiently. SMT solvers help <strong>optimize</strong> these systems by finding the best possible configuration that meets all the necessary constraints.</p>
<p>For instance, in <strong>network design</strong>, you might need to ensure that data flows through the network as efficiently as possible while minimizing costs and avoiding congestion. SMT solvers can handle the complexity of these requirements, modeling both the logical rules that govern the network‚Äôs behavior and the mathematical constraints, such as bandwidth limits or latency requirements.</p>
<p>In <strong>circuit design</strong>, SMT solvers are used to minimize the power consumption, size, and heat production of electronic circuits while ensuring they perform their intended functions correctly. As circuits become more advanced and compact, this optimization process becomes critical for the performance of modern electronics, including smartphones and computer processors.</p>
<p>In large-scale <strong>scheduling</strong> problems‚Äîsuch as assigning shifts to employees or scheduling jobs on machines‚ÄîSMT solvers help find optimal solutions that balance competing demands, such as time constraints, available resources, and efficiency goals. Because SMT solvers can scale to handle thousands of tasks or constraints, they are a powerful tool for solving these optimization problems in real-world industrial settings.</p>
</section>
<section id="advanced-techniques" class="level4">
<h4 class="anchored" data-anchor-id="advanced-techniques">Advanced techniques</h4>
<p>Even though SMT is <strong>NP-hard</strong>, meaning that, in the worst cases, solving these problems can take an enormous amount of time‚Äîthe development of <strong>advanced algorithms</strong> and <strong>heuristics</strong> has made SMT solvers much faster and more practical for real-world applications. SMT solvers use several techniques to reduce the time and resources required to find a solution, including:</p>
<ul>
<li><p><strong>Backtracking</strong>: The solver explores possible solutions and, if it hits a dead end (where a solution doesn‚Äôt work), it backtracks to an earlier decision point and tries a different path. This helps the solver avoid wasting time on unworkable solutions.</p></li>
<li><p><strong>Conflict-Driven Clause Learning (CDCL)</strong>: When the solver encounters a conflict (a situation where no solution can satisfy the current set of constraints), it learns from this conflict to avoid making similar mistakes in the future. This dramatically speeds up the solving process by preventing the solver from revisiting paths that are known to be dead ends.</p></li>
<li><p><strong>Theory Propagation</strong>: Theories in SMT (such as arithmetic or arrays) have their own specific rules. SMT solvers use <strong>theory propagation</strong> to narrow down the possible values for variables based on the rules of these theories. For example, if a variable must satisfy a certain arithmetic equation, the solver can limit the range of possible values for that variable, which reduces the complexity of the search.</p></li>
</ul>
<p>By combining these techniques, SMT solvers are able to handle problems that would be intractable for simpler solvers, allowing them to efficiently solve highly complex and large-scale problems.</p>
</section>
</section>
<section id="combining-multiple-theories" class="level3">
<h3 class="anchored" data-anchor-id="combining-multiple-theories">Combining multiple theories</h3>
<p>One of the key strengths of <strong>SMT solvers</strong> is their ability to handle multiple theories simultaneously, allowing them to solve problems that involve not just simple logic but a mixture of complex mathematical domains. This combination of theories allows SMT solvers to model real-world systems with a higher degree of accuracy and sophistication. By integrating diverse theories, SMT solvers can solve problems that span multiple <strong>domains of mathematics and logic</strong> in a seamless way. Let‚Äôs take a closer look at how multiple theories work together in SMT, and why this makes SMT solvers exceptionally powerful.</p>
<p>When we talk about SMT solvers ‚Äúcombining multiple theories,‚Äù what we really mean is that the solver is capable of reasoning about different kinds of constraints that apply to different types of data‚Äîall at the same time.</p>
<p>Each theory brings its own set of <strong>rules and constraints</strong>. For example:</p>
<ul>
<li><p>Arithmetic theory deals with equations and inequalities.</p></li>
<li><p>Array theory includes operations like indexing and updating.</p></li>
<li><p>Bit-vector theory includes binary manipulations like bit-shifting or bitwise AND/OR operations.</p></li>
</ul>
<p>In real-world applications, it‚Äôs rare for a problem to belong to just one theory. Often, multiple theories are at play. SMT solvers shine in such scenarios by integrating these different theories and <strong>coordinating the solving process</strong> so that constraints from all applicable theories are satisfied simultaneously.</p>
<p>Let‚Äôs now explore some concrete examples where multiple theories interact in SMT.</p>
</section>
<section id="verifying-software-with-mixed-data-types" class="level3">
<h3 class="anchored" data-anchor-id="verifying-software-with-mixed-data-types">Verifying software with mixed data types</h3>
<p>Consider a software verification problem in which a program performs both arithmetic computations and manipulates arrays. Suppose the program performs operations like:</p>
<ol type="1">
<li><p><strong>Arithmetic</strong>: <span class="math inline">x = a + b</span>.</p></li>
<li><p><strong>Array access</strong>: Reading an element from an array <span class="math inline">arr[i]</span>.</p></li>
<li><p><strong>Bitwise operations</strong>: <span class="math inline">z = x \&amp; y</span>, where <span class="math inline">\&amp;</span> is the bitwise AND operation.</p></li>
</ol>
<p>To ensure the correctness of this program, we need to check if the program will behave correctly for any given inputs. Here‚Äôs how <strong>multiple theories</strong> would be combined by the SMT solver:</p>
<ol type="1">
<li><p><strong>Arithmetic theory</strong> will handle the equation <span class="math inline">x = a + b</span>, ensuring that the sum is computed correctly according to arithmetic rules. The solver will also check that variables like <span class="math inline">x</span>, <span class="math inline">a</span>, and <span class="math inline">b</span> are appropriately constrained (e.g., <span class="math inline">x</span> must be an integer).</p></li>
<li><p><strong>Array theory</strong> will handle the operation <span class="math inline">arr[i]</span>, ensuring that the index <span class="math inline">i</span> is valid (i.e., it lies within the bounds of the array). It will also ensure that the right value is retrieved from the array and assigned to the right variable. The solver checks that accessing <span class="math inline">arr[i]</span> doesn‚Äôt lead to an out-of-bounds error.</p></li>
<li><p><strong>Bit-vector theory</strong> will manage the bitwise operation <span class="math inline">z = x \&amp; y</span>, ensuring that the binary representation of <span class="math inline">x</span> and <span class="math inline">y</span> is correctly manipulated at the bit level. This is crucial for many low-level computing tasks, such as encoding or encryption, where binary data is processed.</p></li>
</ol>
<p>By combining these theories, the SMT solver verifies that the program will execute correctly, no matter what values are assigned to the variables. The solver considers all possible inputs and execution paths to prove that there are no runtime errors, incorrect calculations, or invalid memory accesses.</p>
</section>
<section id="a-coordinated-process" class="level3">
<h3 class="anchored" data-anchor-id="a-coordinated-process">A coordinated process</h3>
<p>The magic of SMT solvers lies in their ability to coordinate between these multiple theories while solving a problem. Theories often interact in complex ways, so SMT solvers must <strong>communicate between theories</strong> to resolve constraints effectively. This involves a process known as <strong>theory combination</strong> or <strong>theory propagation</strong>.</p>
<ol type="1">
<li><p><strong>Theory propagation</strong>: Each theory can propagate constraints based on its specific rules. For example, if the arithmetic theory deduces that <span class="math inline">x &gt; 10</span>, then this information is passed to the array theory to check if accessing <span class="math inline">arr[x]</span> is still valid, ensuring <span class="math inline">x</span> doesn‚Äôt exceed the array bounds.</p></li>
<li><p><strong>Conflict resolution</strong>: If a conflict arises‚Äîsuch as the arithmetic theory concluding <span class="math inline">x = 5</span>, while the bit-vector theory requires <span class="math inline">x</span> to have a binary value that would make <span class="math inline">x = 3</span>, the solver identifies this conflict and attempts to resolve it by exploring alternative solutions. This iterative process is essential for finding a solution that satisfies all constraints across different theories.</p></li>
<li><p><strong>Theory interpolation</strong>: When two different theories interact, SMT solvers use techniques like <strong>theory interpolation</strong> to reconcile their different views of the problem. For instance, arithmetic may dictate that <span class="math inline">x = 4</span>, while array theory may require that <span class="math inline">x</span> be within certain index limits. The solver navigates these competing constraints by narrowing down possible values for <span class="math inline">x</span> that satisfy both theories.</p></li>
</ol>
<p>These interactions make SMT solvers <strong>more efficient</strong> at solving problems that would be too difficult for simpler solvers that only handle one theory at a time.</p>
</section>
<section id="flexibility-across-domains" class="level3">
<h3 class="anchored" data-anchor-id="flexibility-across-domains">Flexibility across domains</h3>
<p>The flexibility of SMT solvers to combine multiple theories makes them incredibly versatile. Here are a few real-world examples that highlight their power across different domains:</p>
<ul>
<li><p><strong>Cryptographic verification</strong>: SMT solvers are used to verify cryptographic algorithms, such as those used for data encryption and digital signatures. Cryptographic operations often involve both <strong>arithmetic</strong> (modular arithmetic over large numbers) and <strong>bitwise manipulations</strong> (such as shifting bits or performing XOR operations).</p>
<p>For instance, verifying the correctness of a <strong>RSA encryption algorithm</strong> requires an SMT solver to:</p>
<ul>
<li><p>Check the <strong>modular arithmetic</strong> involved in key generation and encryption.</p></li>
<li><p>Ensure the <strong>bitwise operations</strong> used to encode and decode messages are performed correctly.</p></li>
</ul>
<p>By integrating arithmetic and bit-vector theories, an SMT solver can ensure that the algorithm is mathematically secure and functions as expected for all inputs.</p></li>
<li><p><strong>Optimizing robotic movements</strong>: In modern factories, robots are often programmed to perform complex tasks that involve both <strong>decision-making</strong> (logic) and <strong>precise control of movement</strong> (arithmetic). SMT solvers are used to <strong>optimize robotic movements</strong>, ensuring that they follow the most efficient path while respecting physical constraints like speed, distance, and safety.</p>
<p>An SMT solver may combine:</p>
<ul>
<li><p><strong>Linear arithmetic</strong> to model the robot‚Äôs physical movements.</p></li>
<li><p><strong>Logic</strong> to represent decision-making rules, such as ‚Äúif an obstacle is detected, stop the robot.‚Äù</p></li>
<li><p><strong>Array theory</strong> to manage data about the robot‚Äôs environment and task status.</p></li>
</ul>
<p>By solving these constraints together, the SMT solver finds an optimal plan for the robot that minimizes movement time, avoids obstacles, and completes tasks in the most efficient way possible.</p></li>
<li><p><strong>Artificial Intelligence: Planning and Scheduling</strong>: AI systems often need to make decisions that involve both logic and time-based scheduling. For example, an AI planning system might need to schedule tasks for multiple robots working in parallel, ensuring that each robot finishes its task without clashing with others.</p>
<p>SMT solvers can:</p>
<ul>
<li><p>Use <strong>arithmetic theory</strong> to track time constraints, such as ensuring that task A is completed before task B starts.</p></li>
<li><p>Use <strong>array theory</strong> to keep track of which robot is performing which task.</p></li>
<li><p>Use <strong>logical reasoning</strong> to decide the best sequence of actions.</p></li>
</ul>
<p>By combining these theories, SMT solvers can efficiently plan out the most effective way for robots to complete tasks without delays or conflicts, making AI systems smarter and more reliable.</p></li>
</ul>
</section>
</section>
<section id="z3" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="z3">Z3</h2>
<p><a href="https://www.microsoft.com/en-us/research/project/z3-3/"><strong>Z3</strong></a><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> is one of the most widely-used and powerful SMT solvers, developed by <strong>Microsoft Research</strong>. It is designed to solve logical and mathematical problems that involve both Boolean logic (True/False values) and a variety of mathematical structures, such as integers, real numbers, arrays, bit-vectors, and more. Z3 has become the go-to tool for a wide range of applications, from verifying software correctness to optimizing systems in industrial engineering. Its ability to handle large and complex problems efficiently, while combining different mathematical theories, sets it apart from other solvers.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;de Moura, L., &amp; Bj√∏rner, N. (2008). <strong>Z3: An Efficient SMT Solver</strong>. <em>Tools and Algorithms for the Construction and Analysis of Systems (TACAS)</em>. <a href="https://www.microsoft.com/en-us/research/publication/z3-an-efficient-smt-solver/">Link to paper</a></p></div></div><section id="key-features" class="level3">
<h3 class="anchored" data-anchor-id="key-features">Key features</h3>
<ul>
<li><p><strong>Multi-theory solver</strong>: Z3 can handle problems that involve multiple theories simultaneously, such as <strong>arithmetic</strong>, <strong>bit-vectors</strong>, <strong>arrays</strong>, and <strong>functions</strong>. This makes it versatile enough to solve complex real-world problems that span multiple domains of logic and mathematics. Whether you are working with numerical constraints, manipulating data structures like arrays, or verifying hardware circuits that operate at the bit level, Z3 can manage these interactions seamlessly.</p></li>
<li><p><strong>High efficiency</strong>: Z3 is designed to solve extremely large problems with millions of variables and constraints. It employs advanced techniques, such as <strong>conflict-driven clause learning (CDCL)</strong>, <strong>backtracking</strong>, and <strong>theory propagation</strong>, to explore the search space efficiently. These techniques enable Z3 to quickly find solutions or prove that no solution exists, even for problems that are computationally intensive.</p></li>
<li><p><strong>Combining logical and mathematical constraints</strong>: One of Z3‚Äôs most powerful features is its ability to combine <strong>logical constraints</strong> (such as those used in SAT solving) with <strong>mathematical constraints</strong> (such as equations and inequalities). For example, in software verification, Z3 can check both the logical flow of the program and the correctness of its arithmetic operations, ensuring that a program behaves as expected in all possible scenarios.</p></li>
<li><p><strong>Modularity and extensibility</strong>: Z3 is highly modular, which means that users can extend its capabilities to suit specific applications. It allows developers to define custom theories and tailor the solver‚Äôs behavior to fit the particular needs of their problem domain. This flexibility makes Z3 suitable for a wide range of industries, including aerospace, finance, cybersecurity, and hardware design.</p></li>
<li><p><strong>Rich API support</strong>: Z3 provides rich API support for various programming languages, including Python, C++, and Java. This means that users can integrate Z3 into their existing software tools and workflows easily. For instance, developers can use Z3 within a Python environment to model complex optimization problems, check for software bugs, or verify hardware designs. Its user-friendly interface and robust API make Z3 accessible to both researchers and engineers.</p></li>
<li><p><strong>Proving and model generation</strong>: In addition to solving for satisfiability, Z3 can also be used to <strong>prove the correctness</strong> of formulas or <strong>generate models</strong> that demonstrate specific properties. For example, in verifying a software system, Z3 can either provide a counterexample where the program fails or prove that no such failure exists under any circumstances. This capability is essential in formal methods for software and hardware verification.</p></li>
</ul>
</section>
</section>
<section id="sudoku-time" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sudoku-time">Sudoku time!</h2>
<section id="x9-size" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="x9-size">9x9 size</h3>
<p>Here is the Python code for solving a Sudoku 9x9 puzzle<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> using Z3, including a function that takes the puzzle as input and returns the solved puzzle, along with a main function that demonstrates its use.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;In the world of standard 9x9 Sudoku puzzles, one of the most fascinating mathematical discoveries is the 17-Clue Theorem. In 2012, researchers Gary McGuire, Bastian Tugemann, and Gilles Civario proved through exhaustive computation that 17 is the minimum number of clues required for a standard 9x9 Sudoku puzzle to have a unique solution. See McGuire, G., Tugemann, B., &amp; Civario, G. (2014). There Is No 16-Clue Sudoku: Solving the Sudoku Minimum Number of Clues Problem via Hitting Set Enumeration. Experimental Mathematics, 23(2), 190‚Äì217. https://doi.org/10.1080/10586458.2013.870056</p></div></div><p>Let‚Äôs solve the following:</p>
<table data-quarto-postprocess="true" class="table">
<tbody>
<tr class="odd">
<td style="border: 2px solid #000; padding: 5px">5</td>
<td style="border: 2px solid #000; padding: 5px">3</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px">7</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
</tr>
<tr class="even">
<td style="border: 2px solid #000; padding: 5px">6</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px">1</td>
<td style="border: 2px solid #000; padding: 5px">9</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">5</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
</tr>
<tr class="odd">
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">9</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">8</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">6</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">0</td>
</tr>
<tr class="even">
<td style="border: 2px solid #000; padding: 5px">8</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px">6</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">3</td>
</tr>
<tr class="odd">
<td style="border: 2px solid #000; padding: 5px">4</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px">8</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">3</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">1</td>
</tr>
<tr class="even">
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">7</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">2</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">6</td>
</tr>
<tr class="odd">
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px">6</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px">2</td>
<td style="border: 2px solid #000; padding: 5px">8</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
</tr>
<tr class="even">
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px">4</td>
<td style="border: 2px solid #000; padding: 5px">1</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">9</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">5</td>
</tr>
<tr class="odd">
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px">8</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
<td style="border: 2px solid #000; padding: 5px">0</td>
<td style="border: 2px solid #000; padding: 5px">7</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">9</td>
</tr>
</tbody>
</table>
<p>Code that leverages Z3 is:</p>
<div class="sourceCode" id="annotated-cell-1"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-1-1" class="code-annotation-target"><a href="#annotated-cell-1-1"></a><span class="im">from</span> z3 <span class="im">import</span> Int, Solver, And, Distinct, sat</span>
<span id="annotated-cell-1-2"><a href="#annotated-cell-1-2"></a></span>
<span id="annotated-cell-1-3"><a href="#annotated-cell-1-3"></a><span class="co"># Function to check if the solved Sudoku is correct</span></span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4"></a><span class="kw">def</span> is_valid_sudoku(solution):</span>
<span id="annotated-cell-1-5"><a href="#annotated-cell-1-5"></a>  <span class="co"># Combined row and column checks in a single loop</span></span>
<span id="annotated-cell-1-6"><a href="#annotated-cell-1-6"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>):</span>
<span id="annotated-cell-1-7"><a href="#annotated-cell-1-7"></a>    <span class="co"># Check distinct values in row</span></span>
<span id="annotated-cell-1-8"><a href="#annotated-cell-1-8"></a>    <span class="cf">if</span> <span class="bu">len</span>(<span class="bu">set</span>(solution[i])) <span class="op">!=</span> <span class="dv">9</span>:  </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-1-9" class="code-annotation-target"><a href="#annotated-cell-1-9"></a>      <span class="cf">return</span> <span class="va">False</span></span>
<span id="annotated-cell-1-10"><a href="#annotated-cell-1-10"></a>    </span>
<span id="annotated-cell-1-11"><a href="#annotated-cell-1-11"></a>    <span class="co"># Check distinct values in column</span></span>
<span id="annotated-cell-1-12"><a href="#annotated-cell-1-12"></a>    col <span class="op">=</span> [solution[j][i] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>)]</span>
<span id="annotated-cell-1-13"><a href="#annotated-cell-1-13"></a></span>
<span id="annotated-cell-1-14"><a href="#annotated-cell-1-14"></a>    <span class="cf">if</span> <span class="bu">len</span>(<span class="bu">set</span>(col)) <span class="op">!=</span> <span class="dv">9</span>:</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-1-15" class="code-annotation-target"><a href="#annotated-cell-1-15"></a>      <span class="cf">return</span> <span class="va">False</span></span>
<span id="annotated-cell-1-16"><a href="#annotated-cell-1-16"></a></span>
<span id="annotated-cell-1-17"><a href="#annotated-cell-1-17"></a>  <span class="co"># Check 3x3 subgrids</span></span>
<span id="annotated-cell-1-18"><a href="#annotated-cell-1-18"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">3</span>):</span>
<span id="annotated-cell-1-19"><a href="#annotated-cell-1-19"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">3</span>):</span>
<span id="annotated-cell-1-20"><a href="#annotated-cell-1-20"></a>      subgrid <span class="op">=</span> [solution[i <span class="op">+</span> di][j <span class="op">+</span> dj] <span class="cf">for</span> di <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>) <span class="cf">for</span> dj <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>)]</span>
<span id="annotated-cell-1-21"><a href="#annotated-cell-1-21"></a></span>
<span id="annotated-cell-1-22"><a href="#annotated-cell-1-22"></a>      <span class="cf">if</span> <span class="bu">len</span>(<span class="bu">set</span>(subgrid)) <span class="op">!=</span> <span class="dv">9</span>:</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-1-23" class="code-annotation-target"><a href="#annotated-cell-1-23"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="annotated-cell-1-24"><a href="#annotated-cell-1-24"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-1-25" class="code-annotation-target"><a href="#annotated-cell-1-25"></a>  <span class="cf">return</span> <span class="va">True</span></span>
<span id="annotated-cell-1-26"><a href="#annotated-cell-1-26"></a></span>
<span id="annotated-cell-1-27"><a href="#annotated-cell-1-27"></a><span class="co"># Function to solve a Sudoku puzzle using Z3</span></span>
<span id="annotated-cell-1-28"><a href="#annotated-cell-1-28"></a><span class="kw">def</span> solve_sudoku(puzzle):</span>
<span id="annotated-cell-1-29"><a href="#annotated-cell-1-29"></a>  <span class="co"># Create a 9x9 matrix of integer variables</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-1-30" class="code-annotation-target"><a href="#annotated-cell-1-30"></a>  X <span class="op">=</span> [[Int(<span class="ss">f"x_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>j<span class="sc">}</span><span class="ss">"</span>) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>)] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>)]</span>
<span id="annotated-cell-1-31"><a href="#annotated-cell-1-31"></a>  </span>
<span id="annotated-cell-1-32"><a href="#annotated-cell-1-32"></a>  <span class="co"># Define the solver</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="7" onclick="event.preventDefault();">7</a><span id="annotated-cell-1-33" class="code-annotation-target"><a href="#annotated-cell-1-33"></a>  solver <span class="op">=</span> Solver()</span>
<span id="annotated-cell-1-34"><a href="#annotated-cell-1-34"></a>  </span>
<span id="annotated-cell-1-35"><a href="#annotated-cell-1-35"></a>  <span class="co"># Add constraints for cell values between 1 and 9</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="8" onclick="event.preventDefault();">8</a><span id="annotated-cell-1-36" class="code-annotation-target"><a href="#annotated-cell-1-36"></a>  solver.add([And(X[i][j] <span class="op">&gt;=</span> <span class="dv">1</span>, X[i][j] <span class="op">&lt;=</span> <span class="dv">9</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>)])</span>
<span id="annotated-cell-1-37"><a href="#annotated-cell-1-37"></a>  </span>
<span id="annotated-cell-1-38"><a href="#annotated-cell-1-38"></a>  <span class="co"># Add constraints for the pre-filled cells</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="9" onclick="event.preventDefault();">9</a><span id="annotated-cell-1-39" class="code-annotation-target"><a href="#annotated-cell-1-39"></a>  solver.add([X[i][j] <span class="op">==</span> puzzle[i][j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>) <span class="cf">if</span> puzzle[i][j] <span class="op">!=</span> <span class="dv">0</span>])</span>
<span id="annotated-cell-1-40"><a href="#annotated-cell-1-40"></a>  </span>
<span id="annotated-cell-1-41"><a href="#annotated-cell-1-41"></a>  <span class="co"># Add constraints for rows, columns, and subgrids to contain distinct values</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="10" onclick="event.preventDefault();">10</a><span id="annotated-cell-1-42" class="code-annotation-target"><a href="#annotated-cell-1-42"></a>  solver.add([Distinct(X[i]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>)])  <span class="co"># Row distinct</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="11" onclick="event.preventDefault();">11</a><span id="annotated-cell-1-43" class="code-annotation-target"><a href="#annotated-cell-1-43"></a>  solver.add([Distinct([X[i][j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>)]) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>)])  <span class="co"># Column distinct</span></span>
<span id="annotated-cell-1-44"><a href="#annotated-cell-1-44"></a>  solver.add([Distinct([X[i <span class="op">+</span> di][j <span class="op">+</span> dj] <span class="cf">for</span> di <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>) <span class="cf">for</span> dj <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>)])</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="12" onclick="event.preventDefault();">12</a><span id="annotated-cell-1-45" class="code-annotation-target"><a href="#annotated-cell-1-45"></a>              <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">3</span>) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">3</span>)])  <span class="co"># Subgrid distinct</span></span>
<span id="annotated-cell-1-46"><a href="#annotated-cell-1-46"></a>  </span>
<span id="annotated-cell-1-47"><a href="#annotated-cell-1-47"></a>  <span class="co"># Check if the Sudoku puzzle is solvable</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="13" onclick="event.preventDefault();">13</a><span id="annotated-cell-1-48" class="code-annotation-target"><a href="#annotated-cell-1-48"></a>  <span class="cf">if</span> solver.check() <span class="op">==</span> sat:</span>
<span id="annotated-cell-1-49"><a href="#annotated-cell-1-49"></a>    model <span class="op">=</span> solver.model()</span>
<span id="annotated-cell-1-50"><a href="#annotated-cell-1-50"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="14" onclick="event.preventDefault();">14</a><span id="annotated-cell-1-51" class="code-annotation-target"><a href="#annotated-cell-1-51"></a>    result <span class="op">=</span> [[model.evaluate(X[i][j]).as_long() <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>)] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>)]</span>
<span id="annotated-cell-1-52"><a href="#annotated-cell-1-52"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="15" onclick="event.preventDefault();">15</a><span id="annotated-cell-1-53" class="code-annotation-target"><a href="#annotated-cell-1-53"></a>    <span class="cf">return</span> result</span>
<span id="annotated-cell-1-54"><a href="#annotated-cell-1-54"></a></span>
<span id="annotated-cell-1-55"><a href="#annotated-cell-1-55"></a>  <span class="cf">else</span>:</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="16" onclick="event.preventDefault();">16</a><span id="annotated-cell-1-56" class="code-annotation-target"><a href="#annotated-cell-1-56"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="annotated-cell-1-57"><a href="#annotated-cell-1-57"></a></span>
<span id="annotated-cell-1-58"><a href="#annotated-cell-1-58"></a><span class="co"># Example of solving and checking a Sudoku puzzle</span></span>
<span id="annotated-cell-1-59"><a href="#annotated-cell-1-59"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="annotated-cell-1-60"><a href="#annotated-cell-1-60"></a>  <span class="co"># Input Sudoku puzzle (0 represents empty cells)</span></span>
<span id="annotated-cell-1-61"><a href="#annotated-cell-1-61"></a>  puzzle <span class="op">=</span> [</span>
<span id="annotated-cell-1-62"><a href="#annotated-cell-1-62"></a>    [<span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">7</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="annotated-cell-1-63"><a href="#annotated-cell-1-63"></a>    [<span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="annotated-cell-1-64"><a href="#annotated-cell-1-64"></a>    [<span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>],</span>
<span id="annotated-cell-1-65"><a href="#annotated-cell-1-65"></a>    [<span class="dv">8</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>],</span>
<span id="annotated-cell-1-66"><a href="#annotated-cell-1-66"></a>    [<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="annotated-cell-1-67"><a href="#annotated-cell-1-67"></a>    [<span class="dv">7</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>],</span>
<span id="annotated-cell-1-68"><a href="#annotated-cell-1-68"></a>    [<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">0</span>],</span>
<span id="annotated-cell-1-69"><a href="#annotated-cell-1-69"></a>    [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>],</span>
<span id="annotated-cell-1-70"><a href="#annotated-cell-1-70"></a>    [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">7</span>, <span class="dv">9</span>]</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="17" onclick="event.preventDefault();">17</a><span id="annotated-cell-1-71" class="code-annotation-target"><a href="#annotated-cell-1-71"></a>  ]</span>
<span id="annotated-cell-1-72"><a href="#annotated-cell-1-72"></a></span>
<span id="annotated-cell-1-73"><a href="#annotated-cell-1-73"></a>  <span class="co"># Solve the Sudoku puzzle</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="18" onclick="event.preventDefault();">18</a><span id="annotated-cell-1-74" class="code-annotation-target"><a href="#annotated-cell-1-74"></a>  solved <span class="op">=</span> solve_sudoku(puzzle)</span>
<span id="annotated-cell-1-75"><a href="#annotated-cell-1-75"></a></span>
<span id="annotated-cell-1-76"><a href="#annotated-cell-1-76"></a>  <span class="co"># Print the solved Sudoku puzzle and check if it's valid</span></span>
<span id="annotated-cell-1-77"><a href="#annotated-cell-1-77"></a>  <span class="cf">if</span> solved:</span>
<span id="annotated-cell-1-78"><a href="#annotated-cell-1-78"></a>    <span class="cf">for</span> row <span class="kw">in</span> solved:</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="19" onclick="event.preventDefault();">19</a><span id="annotated-cell-1-79" class="code-annotation-target"><a href="#annotated-cell-1-79"></a>      <span class="bu">print</span>(row)</span>
<span id="annotated-cell-1-80"><a href="#annotated-cell-1-80"></a></span>
<span id="annotated-cell-1-81"><a href="#annotated-cell-1-81"></a>    <span class="co"># Check if the solution is valid</span></span>
<span id="annotated-cell-1-82"><a href="#annotated-cell-1-82"></a>    <span class="cf">if</span> is_valid_sudoku(solved):</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="20" onclick="event.preventDefault();">20</a><span id="annotated-cell-1-83" class="code-annotation-target"><a href="#annotated-cell-1-83"></a>      <span class="bu">print</span>(<span class="st">"The solution is valid!"</span>)</span>
<span id="annotated-cell-1-84"><a href="#annotated-cell-1-84"></a></span>
<span id="annotated-cell-1-85"><a href="#annotated-cell-1-85"></a>    <span class="cf">else</span>:</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="21" onclick="event.preventDefault();">21</a><span id="annotated-cell-1-86" class="code-annotation-target"><a href="#annotated-cell-1-86"></a>      <span class="bu">print</span>(<span class="st">"The solution is not valid!"</span>)</span>
<span id="annotated-cell-1-87"><a href="#annotated-cell-1-87"></a></span>
<span id="annotated-cell-1-88"><a href="#annotated-cell-1-88"></a>  <span class="cf">else</span>:</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="22" onclick="event.preventDefault();">22</a><span id="annotated-cell-1-89" class="code-annotation-target"><a href="#annotated-cell-1-89"></a>    <span class="bu">print</span>(<span class="st">"No solution found."</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="1" data-code-annotation="1">Import required components from the Z3 solver library.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="9" data-code-annotation="2">Check distinct values in row: Ensures each row contains distinct values (1 to 9).</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="15" data-code-annotation="3">Check distinct values in column: Ensures each column contains distinct values (1 to 9).</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="23" data-code-annotation="4">Check 3x3 subgrids: Ensures each 3x3 subgrid contains distinct values.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="25" data-code-annotation="5">Return <code>True</code> if the solution is valid, otherwise return <code>False</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="30" data-code-annotation="6">Create a 9x9 matrix of integer variables using Z3‚Äôs <code>Int</code> to represent each cell.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="33" data-code-annotation="7">Initialize the Z3 solver to begin solving the problem.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="36" data-code-annotation="8">Add constraints to ensure that each cell value is between 1 and 9.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="9">9</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="39" data-code-annotation="9">Add constraints for the pre-filled cells (the given values from the puzzle) to keep them unchanged.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="10">10</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="42" data-code-annotation="10">Add row constraints: Each row must contain distinct values.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="11">11</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="43" data-code-annotation="11">Add column constraints: Each column must contain distinct values.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="12">12</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="45" data-code-annotation="12">Add subgrid constraints: Each 3x3 subgrid must contain distinct values.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="13">13</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="48" data-code-annotation="13">Check if the Sudoku is solvable using the Z3 solver.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="14">14</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="51" data-code-annotation="14">Extract the solution: If a solution is found, extract it from the model.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="15">15</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="53" data-code-annotation="15">Return the solved puzzle.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="16">16</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="56" data-code-annotation="16">Return <code>None</code> if no solution is found.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="17">17</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="71" data-code-annotation="17">Input Sudoku puzzle: A 9x9 grid where <code>0</code> represents empty cells.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="18">18</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="74" data-code-annotation="18">Solve the puzzle: Call the <code>solve_sudoku()</code> function.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="19">19</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="79" data-code-annotation="19">Print the solved puzzle.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="20">20</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="83" data-code-annotation="20">Check if the solution is valid using the <code>is_valid_sudoku()</code> function.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="21">21</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="86" data-code-annotation="21">Print an error message if the solution is not valid.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="22">22</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="89" data-code-annotation="22">Print ‚ÄúNo solution found‚Äù if no solution can be found by the solver.</span>
</dd>
</dl>
<p>Running the code, Z3 gives us:</p>
<table data-quarto-postprocess="true" class="table">
<tbody>
<tr class="odd">
<td style="border: 2px solid #000; padding: 5px">5</td>
<td style="border: 2px solid #000; padding: 5px">3</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">4</td>
<td style="border: 2px solid #000; padding: 5px">6</td>
<td style="border: 2px solid #000; padding: 5px">7</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">8</td>
<td style="border: 2px solid #000; padding: 5px">9</td>
<td style="border: 2px solid #000; padding: 5px">1</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">2</td>
</tr>
<tr class="even">
<td style="border: 2px solid #000; padding: 5px">6</td>
<td style="border: 2px solid #000; padding: 5px">7</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">2</td>
<td style="border: 2px solid #000; padding: 5px">1</td>
<td style="border: 2px solid #000; padding: 5px">9</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">5</td>
<td style="border: 2px solid #000; padding: 5px">3</td>
<td style="border: 2px solid #000; padding: 5px">4</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">8</td>
</tr>
<tr class="odd">
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">1</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">9</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">8</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">3</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">4</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">2</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">5</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">6</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">7</td>
</tr>
<tr class="even">
<td style="border: 2px solid #000; padding: 5px">8</td>
<td style="border: 2px solid #000; padding: 5px">5</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">9</td>
<td style="border: 2px solid #000; padding: 5px">7</td>
<td style="border: 2px solid #000; padding: 5px">6</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">1</td>
<td style="border: 2px solid #000; padding: 5px">4</td>
<td style="border: 2px solid #000; padding: 5px">2</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">3</td>
</tr>
<tr class="odd">
<td style="border: 2px solid #000; padding: 5px">4</td>
<td style="border: 2px solid #000; padding: 5px">2</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">6</td>
<td style="border: 2px solid #000; padding: 5px">8</td>
<td style="border: 2px solid #000; padding: 5px">5</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">3</td>
<td style="border: 2px solid #000; padding: 5px">7</td>
<td style="border: 2px solid #000; padding: 5px">9</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">1</td>
</tr>
<tr class="even">
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">7</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">1</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">3</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">9</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">2</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">4</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">8</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">5</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">6</td>
</tr>
<tr class="odd">
<td style="border: 2px solid #000; padding: 5px">9</td>
<td style="border: 2px solid #000; padding: 5px">6</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">1</td>
<td style="border: 2px solid #000; padding: 5px">5</td>
<td style="border: 2px solid #000; padding: 5px">3</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">7</td>
<td style="border: 2px solid #000; padding: 5px">2</td>
<td style="border: 2px solid #000; padding: 5px">8</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">4</td>
</tr>
<tr class="even">
<td style="border: 2px solid #000; padding: 5px">2</td>
<td style="border: 2px solid #000; padding: 5px">8</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">7</td>
<td style="border: 2px solid #000; padding: 5px">4</td>
<td style="border: 2px solid #000; padding: 5px">1</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">9</td>
<td style="border: 2px solid #000; padding: 5px">6</td>
<td style="border: 2px solid #000; padding: 5px">3</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">5</td>
</tr>
<tr class="odd">
<td style="border: 2px solid #000; padding: 5px">3</td>
<td style="border: 2px solid #000; padding: 5px">4</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">5</td>
<td style="border: 2px solid #000; padding: 5px">2</td>
<td style="border: 2px solid #000; padding: 5px">8</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">6</td>
<td style="border: 2px solid #000; padding: 5px">1</td>
<td style="border: 2px solid #000; padding: 5px">7</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">9</td>
</tr>
</tbody>
</table>
</section>
<section id="some-improvements" class="level3">
<h3 class="anchored" data-anchor-id="some-improvements">Some improvements</h3>
<p>Now we‚Äôll modify the code to handle Sudoku grids of different sizes and provide all solutions.</p>
<p>The provided example is a mini Sudoku:</p>
<table data-quarto-postprocess="true" class="table">
<tbody>
<tr class="odd">
<td style="border: 3px solid #000; padding: 5px">1</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
<td style="border: 3px solid #000; padding: 5px">0</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000">4</td>
</tr>
<tr class="even">
<td style="border: 3px solid #000; padding: 5px; border-bottom: 3px solid #000">0</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">0</td>
<td style="border: 3px solid #000; padding: 5px; border-bottom: 3px solid #000">0</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">0</td>
</tr>
<tr class="odd">
<td style="border: 3px solid #000; padding: 5px">0</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
<td style="border: 3px solid #000; padding: 5px">0</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000">0</td>
</tr>
<tr class="even">
<td style="border: 3px solid #000; padding: 5px; border-bottom: 3px solid #000">4</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">0</td>
<td style="border: 3px solid #000; padding: 5px; border-bottom: 3px solid #000">0</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">1</td>
</tr>
</tbody>
</table>
<p>that is the example input to the following code:</p>
<div class="sourceCode" id="annotated-cell-2"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-2-1" class="code-annotation-target"><a href="#annotated-cell-2-1"></a><span class="im">from</span> z3 <span class="im">import</span> Int, Solver, And, Distinct, Or, sat</span>
<span id="annotated-cell-2-2"><a href="#annotated-cell-2-2"></a></span>
<span id="annotated-cell-2-3"><a href="#annotated-cell-2-3"></a><span class="co"># Function to check if a given Sudoku solution is valid</span></span>
<span id="annotated-cell-2-4"><a href="#annotated-cell-2-4"></a><span class="kw">def</span> is_valid_sudoku(solution):</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-2-5" class="code-annotation-target"><a href="#annotated-cell-2-5"></a>  n <span class="op">=</span> <span class="bu">len</span>(solution)  <span class="co"># Determine the size of the grid</span></span>
<span id="annotated-cell-2-6"><a href="#annotated-cell-2-6"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-2-7" class="code-annotation-target"><a href="#annotated-cell-2-7"></a>  sqrt_n <span class="op">=</span> <span class="bu">int</span>(n<span class="op">**</span><span class="fl">0.5</span>)  <span class="co"># Determine the size of subgrids</span></span>
<span id="annotated-cell-2-8"><a href="#annotated-cell-2-8"></a>  </span>
<span id="annotated-cell-2-9"><a href="#annotated-cell-2-9"></a>  <span class="co"># Check if each row contains distinct values</span></span>
<span id="annotated-cell-2-10"><a href="#annotated-cell-2-10"></a>  <span class="cf">for</span> row <span class="kw">in</span> solution:</span>
<span id="annotated-cell-2-11"><a href="#annotated-cell-2-11"></a>    <span class="co"># Ensure values are within range and distinct</span></span>
<span id="annotated-cell-2-12"><a href="#annotated-cell-2-12"></a>    <span class="cf">if</span> <span class="bu">len</span>(<span class="bu">set</span>(row)) <span class="op">!=</span> n <span class="kw">or</span> <span class="bu">any</span>(x <span class="op">&lt;</span> <span class="dv">1</span> <span class="kw">or</span> x <span class="op">&gt;</span> n <span class="cf">for</span> x <span class="kw">in</span> row): </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-2-13" class="code-annotation-target"><a href="#annotated-cell-2-13"></a>      <span class="cf">return</span> <span class="va">False</span></span>
<span id="annotated-cell-2-14"><a href="#annotated-cell-2-14"></a>  </span>
<span id="annotated-cell-2-15"><a href="#annotated-cell-2-15"></a>  <span class="co"># Check if each column contains distinct values</span></span>
<span id="annotated-cell-2-16"><a href="#annotated-cell-2-16"></a>  <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="annotated-cell-2-17"><a href="#annotated-cell-2-17"></a>    col <span class="op">=</span> [solution[i][j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)]  <span class="co"># Extract each column</span></span>
<span id="annotated-cell-2-18"><a href="#annotated-cell-2-18"></a></span>
<span id="annotated-cell-2-19"><a href="#annotated-cell-2-19"></a>    <span class="cf">if</span> <span class="bu">len</span>(<span class="bu">set</span>(col)) <span class="op">!=</span> n:</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-2-20" class="code-annotation-target"><a href="#annotated-cell-2-20"></a>      <span class="cf">return</span> <span class="va">False</span></span>
<span id="annotated-cell-2-21"><a href="#annotated-cell-2-21"></a></span>
<span id="annotated-cell-2-22"><a href="#annotated-cell-2-22"></a>  <span class="co"># Check if each sqrt_n x sqrt_n subgrid contains distinct values</span></span>
<span id="annotated-cell-2-23"><a href="#annotated-cell-2-23"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n, sqrt_n):</span>
<span id="annotated-cell-2-24"><a href="#annotated-cell-2-24"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n, sqrt_n):</span>
<span id="annotated-cell-2-25"><a href="#annotated-cell-2-25"></a>      subgrid <span class="op">=</span> []  <span class="co"># Collect the values of each subgrid</span></span>
<span id="annotated-cell-2-26"><a href="#annotated-cell-2-26"></a></span>
<span id="annotated-cell-2-27"><a href="#annotated-cell-2-27"></a>      <span class="cf">for</span> di <span class="kw">in</span> <span class="bu">range</span>(sqrt_n):</span>
<span id="annotated-cell-2-28"><a href="#annotated-cell-2-28"></a>        <span class="cf">for</span> dj <span class="kw">in</span> <span class="bu">range</span>(sqrt_n):</span>
<span id="annotated-cell-2-29"><a href="#annotated-cell-2-29"></a>          subgrid.append(solution[i <span class="op">+</span> di][j <span class="op">+</span> dj])</span>
<span id="annotated-cell-2-30"><a href="#annotated-cell-2-30"></a></span>
<span id="annotated-cell-2-31"><a href="#annotated-cell-2-31"></a>      <span class="cf">if</span> <span class="bu">len</span>(<span class="bu">set</span>(subgrid)) <span class="op">!=</span> n:  <span class="co"># Ensure distinct values in subgrid</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-2-32" class="code-annotation-target"><a href="#annotated-cell-2-32"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="annotated-cell-2-33"><a href="#annotated-cell-2-33"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="7" onclick="event.preventDefault();">7</a><span id="annotated-cell-2-34" class="code-annotation-target"><a href="#annotated-cell-2-34"></a>  <span class="cf">return</span> <span class="va">True</span>  <span class="co"># If all checks pass, the solution is valid</span></span>
<span id="annotated-cell-2-35"><a href="#annotated-cell-2-35"></a></span>
<span id="annotated-cell-2-36"><a href="#annotated-cell-2-36"></a><span class="co"># Function to solve Sudoku puzzles where size is determined from the puzzle</span></span>
<span id="annotated-cell-2-37"><a href="#annotated-cell-2-37"></a><span class="kw">def</span> solve_sudoku(puzzle):</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="8" onclick="event.preventDefault();">8</a><span id="annotated-cell-2-38" class="code-annotation-target"><a href="#annotated-cell-2-38"></a>  n <span class="op">=</span> <span class="bu">len</span>(puzzle)  <span class="co"># Determine the size of the grid from the puzzle list</span></span>
<span id="annotated-cell-2-39"><a href="#annotated-cell-2-39"></a>  </span>
<span id="annotated-cell-2-40"><a href="#annotated-cell-2-40"></a>  <span class="co"># Create an n x n matrix of integer variables</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="9" onclick="event.preventDefault();">9</a><span id="annotated-cell-2-41" class="code-annotation-target"><a href="#annotated-cell-2-41"></a>  X <span class="op">=</span> [[Int(<span class="ss">f"x_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>j<span class="sc">}</span><span class="ss">"</span>) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n)] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="annotated-cell-2-42"><a href="#annotated-cell-2-42"></a>  </span>
<span id="annotated-cell-2-43"><a href="#annotated-cell-2-43"></a>  <span class="co"># Define the solver</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="10" onclick="event.preventDefault();">10</a><span id="annotated-cell-2-44" class="code-annotation-target"><a href="#annotated-cell-2-44"></a>  solver <span class="op">=</span> Solver()</span>
<span id="annotated-cell-2-45"><a href="#annotated-cell-2-45"></a>  </span>
<span id="annotated-cell-2-46"><a href="#annotated-cell-2-46"></a>  <span class="co"># Add constraints for cell values between 1 and n</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="11" onclick="event.preventDefault();">11</a><span id="annotated-cell-2-47" class="code-annotation-target"><a href="#annotated-cell-2-47"></a>  solver.add([And(X[i][j] <span class="op">&gt;=</span> <span class="dv">1</span>, X[i][j] <span class="op">&lt;=</span> n) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n)])</span>
<span id="annotated-cell-2-48"><a href="#annotated-cell-2-48"></a>  </span>
<span id="annotated-cell-2-49"><a href="#annotated-cell-2-49"></a>  <span class="co"># Add constraints for the pre-filled cells</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="12" onclick="event.preventDefault();">12</a><span id="annotated-cell-2-50" class="code-annotation-target"><a href="#annotated-cell-2-50"></a>  solver.add([X[i][j] <span class="op">==</span> puzzle[i][j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n) <span class="cf">if</span> puzzle[i][j] <span class="op">!=</span> <span class="dv">0</span>])</span>
<span id="annotated-cell-2-51"><a href="#annotated-cell-2-51"></a>  </span>
<span id="annotated-cell-2-52"><a href="#annotated-cell-2-52"></a>  <span class="co"># Add row constraints: each row must contain distinct values</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="13" onclick="event.preventDefault();">13</a><span id="annotated-cell-2-53" class="code-annotation-target"><a href="#annotated-cell-2-53"></a>  solver.add([Distinct(X[i]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)])</span>
<span id="annotated-cell-2-54"><a href="#annotated-cell-2-54"></a>  </span>
<span id="annotated-cell-2-55"><a href="#annotated-cell-2-55"></a>  <span class="co"># Add column constraints: each column must contain distinct values</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="14" onclick="event.preventDefault();">14</a><span id="annotated-cell-2-56" class="code-annotation-target"><a href="#annotated-cell-2-56"></a>  solver.add([Distinct([X[i][j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)]) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n)])</span>
<span id="annotated-cell-2-57"><a href="#annotated-cell-2-57"></a>  </span>
<span id="annotated-cell-2-58"><a href="#annotated-cell-2-58"></a>  <span class="co"># Add subgrid constraints: each sqrt_n x sqrt_n subgrid must contain distinct values</span></span>
<span id="annotated-cell-2-59"><a href="#annotated-cell-2-59"></a>  sqrt_n <span class="op">=</span> <span class="bu">int</span>(n<span class="op">**</span><span class="fl">0.5</span>)</span>
<span id="annotated-cell-2-60"><a href="#annotated-cell-2-60"></a></span>
<span id="annotated-cell-2-61"><a href="#annotated-cell-2-61"></a>  solver.add([Distinct([X[i <span class="op">+</span> di][j <span class="op">+</span> dj] <span class="cf">for</span> di <span class="kw">in</span> <span class="bu">range</span>(sqrt_n) <span class="cf">for</span> dj <span class="kw">in</span> <span class="bu">range</span>(sqrt_n)])</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="15" onclick="event.preventDefault();">15</a><span id="annotated-cell-2-62" class="code-annotation-target"><a href="#annotated-cell-2-62"></a>              <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n, sqrt_n) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n, sqrt_n)])</span>
<span id="annotated-cell-2-63"><a href="#annotated-cell-2-63"></a>  </span>
<span id="annotated-cell-2-64"><a href="#annotated-cell-2-64"></a>  <span class="co"># Find all possible solutions</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="16" onclick="event.preventDefault();">16</a><span id="annotated-cell-2-65" class="code-annotation-target"><a href="#annotated-cell-2-65"></a>  solutions <span class="op">=</span> []  <span class="co"># List to store all solutions</span></span>
<span id="annotated-cell-2-66"><a href="#annotated-cell-2-66"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="17" onclick="event.preventDefault();">17</a><span id="annotated-cell-2-67" class="code-annotation-target"><a href="#annotated-cell-2-67"></a>  <span class="cf">while</span> solver.check() <span class="op">==</span> sat:</span>
<span id="annotated-cell-2-68"><a href="#annotated-cell-2-68"></a>    model <span class="op">=</span> solver.model()</span>
<span id="annotated-cell-2-69"><a href="#annotated-cell-2-69"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="18" onclick="event.preventDefault();">18</a><span id="annotated-cell-2-70" class="code-annotation-target"><a href="#annotated-cell-2-70"></a>    solution <span class="op">=</span> [[model.evaluate(X[i][j]).as_long() <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n)] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="annotated-cell-2-71"><a href="#annotated-cell-2-71"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="19" onclick="event.preventDefault();">19</a><span id="annotated-cell-2-72" class="code-annotation-target"><a href="#annotated-cell-2-72"></a>    solutions.append(solution)  <span class="co"># Store the solution</span></span>
<span id="annotated-cell-2-73"><a href="#annotated-cell-2-73"></a></span>
<span id="annotated-cell-2-74"><a href="#annotated-cell-2-74"></a>    <span class="co"># Add a constraint to prevent finding the same solution again</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="20" onclick="event.preventDefault();">20</a><span id="annotated-cell-2-75" class="code-annotation-target"><a href="#annotated-cell-2-75"></a>    solver.add(Or([X[i][j] <span class="op">!=</span> solution[i][j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n)]))</span>
<span id="annotated-cell-2-76"><a href="#annotated-cell-2-76"></a>  </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="21" onclick="event.preventDefault();">21</a><span id="annotated-cell-2-77" class="code-annotation-target"><a href="#annotated-cell-2-77"></a>  <span class="cf">return</span> solutions  <span class="co"># Return all solutions</span></span>
<span id="annotated-cell-2-78"><a href="#annotated-cell-2-78"></a></span>
<span id="annotated-cell-2-79"><a href="#annotated-cell-2-79"></a><span class="co"># Example of a 4x4 Sudoku puzzle with multiple solutions</span></span>
<span id="annotated-cell-2-80"><a href="#annotated-cell-2-80"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="annotated-cell-2-81"><a href="#annotated-cell-2-81"></a>  <span class="co"># 4x4 Sudoku puzzle (0 represents empty cells)</span></span>
<span id="annotated-cell-2-82"><a href="#annotated-cell-2-82"></a>  puzzle <span class="op">=</span> [</span>
<span id="annotated-cell-2-83"><a href="#annotated-cell-2-83"></a>    [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>],</span>
<span id="annotated-cell-2-84"><a href="#annotated-cell-2-84"></a>    [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="annotated-cell-2-85"><a href="#annotated-cell-2-85"></a>    [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="annotated-cell-2-86"><a href="#annotated-cell-2-86"></a>    [<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>]</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="22" onclick="event.preventDefault();">22</a><span id="annotated-cell-2-87" class="code-annotation-target"><a href="#annotated-cell-2-87"></a>  ]</span>
<span id="annotated-cell-2-88"><a href="#annotated-cell-2-88"></a></span>
<span id="annotated-cell-2-89"><a href="#annotated-cell-2-89"></a>  <span class="co"># Solve the Sudoku puzzle (size will be determined automatically)</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="23" onclick="event.preventDefault();">23</a><span id="annotated-cell-2-90" class="code-annotation-target"><a href="#annotated-cell-2-90"></a>  solutions <span class="op">=</span> solve_sudoku(puzzle)</span>
<span id="annotated-cell-2-91"><a href="#annotated-cell-2-91"></a></span>
<span id="annotated-cell-2-92"><a href="#annotated-cell-2-92"></a>  <span class="co"># Print all the solutions and check if they're valid</span></span>
<span id="annotated-cell-2-93"><a href="#annotated-cell-2-93"></a>  <span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span><span class="bu">len</span>(solutions)<span class="sc">}</span><span class="ss"> solution(s):"</span>)</span>
<span id="annotated-cell-2-94"><a href="#annotated-cell-2-94"></a>  <span class="cf">for</span> idx, solution <span class="kw">in</span> <span class="bu">enumerate</span>(solutions):</span>
<span id="annotated-cell-2-95"><a href="#annotated-cell-2-95"></a>    <span class="bu">print</span>(<span class="ss">f"Solution </span><span class="sc">{</span>idx <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="annotated-cell-2-96"><a href="#annotated-cell-2-96"></a></span>
<span id="annotated-cell-2-97"><a href="#annotated-cell-2-97"></a>    <span class="cf">for</span> row <span class="kw">in</span> solution:</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="24" onclick="event.preventDefault();">24</a><span id="annotated-cell-2-98" class="code-annotation-target"><a href="#annotated-cell-2-98"></a>      <span class="bu">print</span>(row)</span>
<span id="annotated-cell-2-99"><a href="#annotated-cell-2-99"></a></span>
<span id="annotated-cell-2-100"><a href="#annotated-cell-2-100"></a>    <span class="bu">print</span>()</span>
<span id="annotated-cell-2-101"><a href="#annotated-cell-2-101"></a>    </span>
<span id="annotated-cell-2-102"><a href="#annotated-cell-2-102"></a>    <span class="co"># Check if the solution is valid</span></span>
<span id="annotated-cell-2-103"><a href="#annotated-cell-2-103"></a>    <span class="cf">if</span> is_valid_sudoku(solution):</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="25" onclick="event.preventDefault();">25</a><span id="annotated-cell-2-104" class="code-annotation-target"><a href="#annotated-cell-2-104"></a>      <span class="bu">print</span>(<span class="st">"The solution is valid!"</span>)</span>
<span id="annotated-cell-2-105"><a href="#annotated-cell-2-105"></a></span>
<span id="annotated-cell-2-106"><a href="#annotated-cell-2-106"></a>    <span class="cf">else</span>:</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="26" onclick="event.preventDefault();">26</a><span id="annotated-cell-2-107" class="code-annotation-target"><a href="#annotated-cell-2-107"></a>      <span class="bu">print</span>(<span class="st">"The solution is not valid!"</span>)</span>
<span id="annotated-cell-2-108"><a href="#annotated-cell-2-108"></a></span>
<span id="annotated-cell-2-109"><a href="#annotated-cell-2-109"></a>    <span class="bu">print</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="1" data-code-annotation="1">Import required components from the Z3 solver library.</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="5" data-code-annotation="2">Determine the grid size from the solution passed to <code>is_valid_sudoku</code>.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="7" data-code-annotation="3">Determine subgrid size based on the square root of the grid size (for 4x4, this would be 2x2 subgrids).</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="13" data-code-annotation="4">Check rows: Ensure each row has distinct values between 1 and n.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="20" data-code-annotation="5">Check columns: Ensure each column has distinct values.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="32" data-code-annotation="6">Check subgrids: Ensure each subgrid contains distinct values.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="34" data-code-annotation="7">Return <code>True</code> if all checks pass, meaning the solution is valid.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="38" data-code-annotation="8">Determine puzzle size from the input list. This makes the function adaptable to any Sudoku size (e.g., 4x4, 9x9).<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="9">9</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="41" data-code-annotation="9">Create integer variables to represent each cell in the Sudoku grid.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="10">10</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="44" data-code-annotation="10">Initialize the Z3 solver. # &lt;10&gt;</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="11">11</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="47" data-code-annotation="11">Add constraints to ensure each cell‚Äôs value is between 1 and n.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="12">12</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="50" data-code-annotation="12">Add constraints for the pre-filled cells in the puzzle.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="13">13</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="53" data-code-annotation="13">Ensure distinct values in each row.</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="14">14</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="56" data-code-annotation="14">Ensure distinct values in each column.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="15">15</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="62" data-code-annotation="15">Ensure distinct values in each subgrid.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="16">16</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="65" data-code-annotation="16">Initialize list to store all solutions.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="17">17</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="67" data-code-annotation="17">Check if the puzzle is solvable using Z3‚Äôs <code>sat</code> check.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="18">18</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="70" data-code-annotation="18">Extract the solution from the model if it‚Äôs solvable.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="19">19</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="72" data-code-annotation="19">Store each solution in the <code>solutions</code> list.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="20">20</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="75" data-code-annotation="20">Add constraint to ensure the solver does not return the same solution again.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="21">21</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="77" data-code-annotation="21">Return all found solutions.</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="22">22</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="87" data-code-annotation="22">Define a 4x4 Sudoku puzzle. Empty cells are represented by <code>0</code>.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="23">23</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="90" data-code-annotation="23">Solve the puzzle and automatically determine the size.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="24">24</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="98" data-code-annotation="24">Print each solution.</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="25">25</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="104" data-code-annotation="25">Check if the solution is valid using the <code>is_valid_sudoku()</code> function.</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="26">26</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="107" data-code-annotation="26">Print validation result for each solution.</span>
</dd>
</dl>
<p>And the output is composed of two solutions:</p>
<table data-quarto-postprocess="true" class="table">
<caption>Solution 1</caption>
<tbody>
<tr class="odd">
<td style="border: 3px solid #000; padding: 5px">1</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000">3</td>
<td style="border: 3px solid #000; padding: 5px">2</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000">4</td>
</tr>
<tr class="even">
<td style="border: 3px solid #000; padding: 5px; border-bottom: 3px solid #000">2</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">4</td>
<td style="border: 3px solid #000; padding: 5px; border-bottom: 3px solid #000">1</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">3</td>
</tr>
<tr class="odd">
<td style="border: 3px solid #000; padding: 5px">3</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000">1</td>
<td style="border: 3px solid #000; padding: 5px">4</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000">2</td>
</tr>
<tr class="even">
<td style="border: 3px solid #000; padding: 5px">4</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000">2</td>
<td style="border: 3px solid #000; padding: 5px">3</td>
<td style="border: 3px solid #000; padding: 5px; border-right: 3px solid #000">1</td>
</tr>
</tbody>
</table>
<p>and</p>
<table data-quarto-postprocess="true" class="table">
<caption>Solution 2</caption>
<tbody>
<tr class="odd">
<td style="border: 2px solid #000; padding: 5px">1</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">2</td>
<td style="border: 2px solid #000; padding: 5px">3</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">4</td>
</tr>
<tr class="even">
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">3</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">4</td>
<td style="border: 2px solid #000; padding: 5px; border-bottom: 3px solid #000">1</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000; border-bottom: 3px solid #000">2</td>
</tr>
<tr class="odd">
<td style="border: 2px solid #000; padding: 5px">2</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">1</td>
<td style="border: 2px solid #000; padding: 5px">4</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">3</td>
</tr>
<tr class="even">
<td style="border: 2px solid #000; padding: 5px">4</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">3</td>
<td style="border: 2px solid #000; padding: 5px">2</td>
<td style="border: 2px solid #000; padding: 5px; border-right: 3px solid #000">1</td>
</tr>
</tbody>
</table>


</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/antomon\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="antomon/antomon-utterances" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Antonio Montano‚Äôs personal blog</p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../about.html">
<p>About</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../contents/services.html">
<p>Services</p>
</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/montano/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/antomon">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/antomon">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 ¬© Antonio Montano, 2024
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">
<p><img src="https://raw.githubusercontent.com/antomon/antomon.github.io/cd7dbf5f81371c6eb1c3c7e8a32ac35f44b3bbce/by-nc-nd.svg" class="img-fluid"></p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>